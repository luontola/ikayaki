<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Squid: My Documents/squid/src/ikayaki/gui/FittedComboBoxRenderer.java Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">My Documents</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">squid</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">ikayaki</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">gui</a></div>
<h1>FittedComboBoxRenderer.java</h1><a href="_fitted_combo_box_renderer_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * FittedComboBoxRenderer.java</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Copyright (C) 2005 Project SQUID, http://www.cs.helsinki.fi/group/squid/</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * This file is part of Ikayaki.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * Ikayaki is free software; you can redistribute it and/or modify</span>
00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00011 <span class="comment"> * (at your option) any later version.</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * Ikayaki is distributed in the hope that it will be useful,</span>
00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
00016 <span class="comment"> * GNU General Public License for more details.</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00019 <span class="comment"> * along with Ikayaki; if not, write to the Free Software</span>
00020 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
00021 <span class="comment"> */</span>
00022 
00023 <span class="keyword">package </span>ikayaki.gui;
00024 
00025 <span class="keyword">import</span> javax.swing.*;
00026 <span class="keyword">import</span> javax.swing.plaf.basic.BasicComboBoxRenderer;
00027 <span class="keyword">import</span> java.awt.*;
00028 
<a name="l00035"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html">00035</a> <span class="keyword">class </span><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html">FittedComboBoxRenderer</a> <span class="keyword">extends</span> BasicComboBoxRenderer {
00036 
<a name="l00037"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r0">00037</a>     <span class="keyword">private</span> JComponent <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r0">fitToComponent</a>;
<a name="l00038"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">00038</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">fitLimit</a> = -1;
00039 
<a name="l00040"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r2">00040</a>     <span class="keyword">private</span> String <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r2">delimiter</a>;
<a name="l00041"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r3">00041</a>     <span class="keyword">private</span> String <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r3">delimiterRegexp</a>;
00042 
<a name="l00050"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a0">00050</a>     <span class="keyword">public</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a0">FittedComboBoxRenderer</a>(JComponent <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r0">fitToComponent</a>) {
00051         <span class="keywordflow">if</span> (fitToComponent == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00052             <span class="keywordflow">throw</span> <span class="keyword">new</span> NullPointerException();
00053         }
00054         <span class="keyword">this</span>.fitToComponent = fitToComponent;
00055         <span class="keyword">this</span>.delimiter = <span class="stringliteral">"\\"</span>;
00056         <span class="keyword">this</span>.delimiterRegexp = <span class="stringliteral">"\\\\"</span>;
00057     }
00058 
<a name="l00068"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a1">00068</a>     <span class="keyword">public</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a0">FittedComboBoxRenderer</a>(JComponent <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r0">fitToComponent</a>, String <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r2">delimiter</a>, String regexp) {
00069         <span class="keywordflow">if</span> (fitToComponent == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || delimiter == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || regexp == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00070             <span class="keywordflow">throw</span> <span class="keyword">new</span> NullPointerException();
00071         }
00072         <span class="keyword">this</span>.fitToComponent = fitToComponent;
00073         <span class="keyword">this</span>.delimiter = delimiter;
00074         <span class="keyword">this</span>.delimiterRegexp = regexp;
00075     }
00076 
<a name="l00080"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a2">00080</a>     <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a2">getFitLimit</a>() {
00081         <span class="keywordflow">return</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">fitLimit</a>;
00082     }
00083 
<a name="l00089"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a3">00089</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a3">setFitLimit</a>(<span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">fitLimit</a>) {
00090         <span class="keyword">this</span>.fitLimit = fitLimit;
00091     }
00092 
<a name="l00093"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a4">00093</a>     @Override <span class="keyword">public</span> Component <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a4">getListCellRendererComponent</a>(JList list, Object <a class="code" href="namespaceikayaki_1_1gui.html#a26a3">value</a>, <span class="keywordtype">int</span> index, <span class="keywordtype">boolean</span> isSelected,
00094                                                             <span class="keywordtype">boolean</span> cellHasFocus) {
00095         JLabel comp = (JLabel) super.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
00096         <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">fitLimit</a> &gt;= 0) {
00097             <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a5">fitValue</a>(value, <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">fitLimit</a>);
00098         } <span class="keywordflow">else</span> {
00099             <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a5">fitValue</a>(value);
00100         }
00101         <span class="keywordflow">return</span> comp;
00102     }
00103 
<a name="l00112"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a5">00112</a>     <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a5">fitValue</a>(Object <a class="code" href="namespaceikayaki_1_1gui.html#a26a3">value</a>) {
00113         <span class="keywordflow">return</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a5">fitValue</a>(value, -1);
00114     }
00115 
<a name="l00124"></a><a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a6">00124</a>     <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#a5">fitValue</a>(Object <a class="code" href="namespaceikayaki_1_1gui.html#a26a3">value</a>, <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r1">fitLimit</a>) {
00125         <span class="keywordtype">int</span> maxWidth = <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r0">fitToComponent</a>.getWidth();
00126         <span class="keywordtype">int</span> fitCount = 0;
00127 
00128         <span class="comment">// set the text and split it</span>
00129         <span class="keyword">this</span>.setText(value.toString());
00130         String[] text = value.toString().split(<a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r3">delimiterRegexp</a>);
00131         <span class="keywordflow">if</span> (text.length &lt; 3) {
00132             <span class="keywordflow">return</span> 0;               <span class="comment">// unable to chop any smaller</span>
00133         }
00134         <span class="keywordflow">if</span> (fitLimit &lt; 0) {
00135             <span class="comment">// autodetecting enabled</span>
00136             <span class="keywordflow">if</span> (maxWidth &gt; <span class="keyword">this</span>.getPreferredSize().width) {
00137                 <span class="keywordflow">return</span> 0;           <span class="comment">// it already fits</span>
00138             }
00139         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fitLimit == 0) {
00140             <span class="keywordflow">return</span> 0;               <span class="comment">// forbidden to chop any smaller</span>
00141         }
00142 
00143         <span class="comment">// take out parts of the text it until it fits</span>
00144         <span class="keywordtype">boolean</span> shortenMore = <span class="keyword">true</span>;
00145         <span class="keywordflow">while</span> (shortenMore) {
00146             shortenMore = <span class="keyword">false</span>;    <span class="comment">// stop the loop, unless somebody tells us to continue</span>
00147 
00148             <span class="keywordflow">if</span> (fitLimit &gt;= 0) {
00149                 <span class="comment">// take the specified number of parts out of the text</span>
00150                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; text.length - 1 &amp;&amp; fitLimit &gt; 0; i++, fitLimit--) {
00151                     text[i] = <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00152                     fitCount++;
00153                 }
00154             } <span class="keywordflow">else</span> {
00155                 <span class="comment">// take out one part of the text at a time</span>
00156                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; text.length - 1; i++) {
00157                     <span class="keywordflow">if</span> (text[i] != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00158                         text[i] = <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00159                         shortenMore = <span class="keyword">true</span>;     <span class="comment">// try again if it doesn't fit</span>
00160                         fitCount++;
00161                         <span class="keywordflow">break</span>;
00162                     }
00163                 }
00164             }
00165 
00166             <span class="comment">// put the text together</span>
00167             String result = text[0] + <a class="code" href="classikayaki_1_1gui_1_1_fitted_combo_box_renderer.html#r2">delimiter</a> + <span class="stringliteral">"..."</span>;
00168             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; text.length; i++) {
00169                 <span class="keywordflow">if</span> (text[i] != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00170                     result += delimiter + text[i];
00171                 }
00172             }
00173 
00174             <span class="comment">// try if it fits</span>
00175             <span class="keyword">this</span>.setText(result);
00176             <span class="keywordflow">if</span> (maxWidth &gt; <span class="keyword">this</span>.getPreferredSize().width) {
00177                 shortenMore = <span class="keyword">false</span>;
00178             }
00179         }
00180         <span class="keywordflow">return</span> fitCount;
00181     }
00182 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed May 4 13:11:03 2005 for Squid by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
