<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Squid: My Documents/squid/src/ikayaki/gui/MagnetometerStatusPanel.java Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">My Documents</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">squid</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">ikayaki</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">gui</a></div>
<h1>MagnetometerStatusPanel.java</h1><a href="_magnetometer_status_panel_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * MagnetometerStatusPanel.java</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Copyright (C) 2005 Project SQUID, http://www.cs.helsinki.fi/group/squid/</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * This file is part of Ikayaki.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * Ikayaki is free software; you can redistribute it and/or modify</span>
00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00011 <span class="comment"> * (at your option) any later version.</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * Ikayaki is distributed in the hope that it will be useful,</span>
00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
00016 <span class="comment"> * GNU General Public License for more details.</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00019 <span class="comment"> * along with Ikayaki; if not, write to the Free Software</span>
00020 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
00021 <span class="comment"> */</span>
00022 
00023 <span class="keyword">package </span>ikayaki.gui;
00024 
00025 <span class="keyword">import</span> ikayaki.MeasurementEvent;
00026 <span class="keyword">import</span> ikayaki.MeasurementListener;
00027 <span class="keyword">import</span> ikayaki.Project;
00028 <span class="keyword">import</span> ikayaki.Settings;
00029 <span class="keyword">import</span> ikayaki.squid.Squid;
00030 
00031 <span class="keyword">import</span> javax.swing.*;
00032 <span class="keyword">import</span> java.awt.*;
00033 <span class="keyword">import</span> java.awt.event.ActionEvent;
00034 <span class="keyword">import</span> java.awt.event.ActionListener;
00035 <span class="keyword">import</span> java.util.TreeMap;
00036 
<a name="l00044"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html">00044</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html">MagnetometerStatusPanel</a> <span class="keyword">extends</span> JPanel implements <a class="code" href="interfaceikayaki_1_1_measurement_listener.html">MeasurementListener</a> {
00045 
<a name="l00046"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s0">00046</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Color <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s0">DEMAGNETIZING_COLOR</a> = <span class="keyword">new</span> Color(0xFFCCCC);
<a name="l00047"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s1">00047</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Color <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s1">MEASURING_COLOR</a> = <span class="keyword">new</span> Color(0xFFFF99);
<a name="l00048"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s2">00048</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Color <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s2">MOVING_COLOR</a> = <span class="keyword">new</span> Color(0xCCCCFF);
<a name="l00049"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s3">00049</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Color <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s3">IDLE_COLOR</a> = Color.WHITE;
00050 
<a name="l00054"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">00054</a>     <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html">ManualControlsPanel</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>;
00055 
00056 <span class="comment">//    /**</span>
00057 <span class="comment">//     * Status picture animator.</span>
00058 <span class="comment">//     */</span>
00059 <span class="comment">//    private final MagnetometerStatusAnimator statusAnimator;</span>
00060 
<a name="l00065"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">00065</a>     <span class="keyword">private</span> <a class="code" href="classikayaki_1_1squid_1_1_squid.html">Squid</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a> = <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00066 
00067     <span class="comment">// handler current position and rotation</span>
<a name="l00068"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">00068</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a> = 0;
<a name="l00069"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">00069</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a> = 0;
<a name="l00070"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r3">00070</a>     <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r3">moving</a> = <span class="keyword">false</span>;
<a name="l00071"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r4">00071</a>     <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r4">rotating</a> = <span class="keyword">false</span>;
00072 
00073     <span class="comment">// status of the degausser and magnetometer</span>
<a name="l00074"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r5">00074</a>     <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r5">demagnetizing</a> = <span class="keyword">false</span>;
<a name="l00075"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r6">00075</a>     <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r6">measuring</a> = <span class="keyword">false</span>;
00076 
00077     <span class="comment">// handler max position and max rotation for drawing</span>
00078     <span class="comment">// TODO: some way to get the actual max-position?</span>
<a name="l00079"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r8">00079</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a> = 50000, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r8">maxrotation</a> = 360;
00080 
00081     <span class="comment">// handler positions, read from Settings</span>
00082     <span class="comment">// WARNING: all of these must differ or we have trouble...</span>
<a name="l00083"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r9">00083</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r9">posMove</a> = -2;
<a name="l00084"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r10">00084</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r10">posLeft</a> = -1;
<a name="l00085"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r11">00085</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r11">posHome</a>;
<a name="l00086"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r12">00086</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r12">posDemagZ</a>;
<a name="l00087"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r13">00087</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r13">posDemagY</a>;
<a name="l00088"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r14">00088</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r14">posBG</a>;
<a name="l00089"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r15">00089</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r15">posMeasure</a>;
<a name="l00090"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r16">00090</a>     <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r16">posRight</a> = 2 &lt;&lt; 24 - 1;
00091 
<a name="l00095"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">00095</a>     <span class="keyword">private</span> TreeMap&lt;Integer, JComponent&gt; <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a> = <span class="keyword">new</span> TreeMap&lt;Integer, JComponent&gt;();
00096 
<a name="l00100"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a0">00100</a>     <span class="keyword">public</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a0">MagnetometerStatusPanel</a>() {
00101         <span class="keyword">this</span>.setLayout(<span class="keyword">new</span> OverlayLayout(<span class="keyword">this</span>));
00102 
00103         <span class="keyword">this</span>.manualControlsPanel = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html">ManualControlsPanel</a>();
00104 <span class="comment">//        this.statusAnimator = new MagnetometerStatusAnimator();</span>
00105 
00106         <span class="comment">// move-radiobuttons come left from status picture</span>
00107         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">moveLabel</a>);
00108         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">moveLeft</a>);
00109         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r3">moveHome</a>);
00110         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r4">moveDemagZ</a>);
00111         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r5">moveDemagY</a>);
00112         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r6">moveBG</a>);
00113         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r7">moveMeasure</a>);
00114         add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r8">moveRight</a>);
00115 
00116         setPreferredSize(<span class="keyword">new</span> Dimension(150, 400));
00117         <span class="comment">//setMinimumSize(new Dimension(150, 400));</span>
00118 
00119         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d0">updatePositions</a>();
00120         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a2">updateStatus</a>();
00121 
00122         <span class="comment">// let's needlesly redraw status picture even when nothing happens</span>
00123         <span class="keyword">new</span> Timer(50, <span class="keyword">new</span> ActionListener() {
00124             <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00125                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a2">updateStatus</a>();
00126             }
00127         }).start();
00128     }
00129 
<a name="l00134"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a1">00134</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a1">setSquid</a>(<a class="code" href="classikayaki_1_1squid_1_1_squid.html">Squid</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>) {
00135         <span class="keyword">this</span>.squid = squid;
00136         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a2">updateStatus</a>();
00137         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a1">setEnabled</a>();
00138     }
00139 
<a name="l00144"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d0">00144</a>     <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d0">updatePositions</a>() {
00145         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r11">posHome</a> = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerSampleLoadPosition();
00146         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r12">posDemagZ</a> = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerAxialAFPosition();
00147         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r13">posDemagY</a> = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerTransverseYAFPosition();
00148         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r14">posBG</a> = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerBackgroundPosition();
00149         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r15">posMeasure</a> = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerMeasurementPosition();
00150 
00151         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a> = 1;
00152         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pos : <span class="keyword">new</span> <span class="keywordtype">int</span>[]{<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r11">posHome</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r12">posDemagZ</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r13">posDemagY</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r14">posBG</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r15">posMeasure</a>}) {
00153             <span class="keywordflow">if</span> (pos &gt; <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a>) <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a> = pos;
00154         }
00155         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a> *= 1.2;
00156 
00157         <span class="comment">// stack move-radiobuttons into a sorted map</span>
00158         <span class="comment">// TODO: WARNING: if two positions are the same, previous one gets replaced</span>
00159         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.clear();
00160         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r9">posMove</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">moveLabel</a>);
00161         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r10">posLeft</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">moveLeft</a>);
00162         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(posHome), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r3">moveHome</a>);
00163         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r12">posDemagZ</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r4">moveDemagZ</a>);
00164         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r13">posDemagY</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r5">moveDemagY</a>);
00165         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r14">posBG</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r6">moveBG</a>);
00166         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r15">posMeasure</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r7">moveMeasure</a>);
00167         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.put(<span class="keyword">new</span> Integer(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r16">posRight</a>), <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r8">moveRight</a>);
00168 
00169         <span class="comment">// TODO: only need to call updateButtonPositions here, but it won't work so now it's called</span>
00170         <span class="comment">// every time in paintComponent</span>
00171     }
00172 
<a name="l00176"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d1">00176</a>     <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d1">updateButtonPositions</a>() {
00177         <span class="keywordtype">int</span> height = getHeight(), nextpos = 0;
00178         <span class="keywordflow">for</span> (Integer <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a> : <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.keySet()) {
00179             JComponent c = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r17">moveButtons</a>.get(position);
00180             <span class="keywordtype">int</span> cheight = c.getHeight();
00181             <span class="keywordtype">int</span> pos = (int) ((long) height * position / <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a>);
00182             <span class="keywordflow">if</span> (pos &gt; height - cheight) pos = height - cheight;
00183             <span class="keywordflow">if</span> (pos &lt; nextpos) pos = nextpos;
00184             c.setLocation(c.getX(), pos);
00185             nextpos = pos + cheight;
00186         }
00187     }
00188 
<a name="l00192"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a2">00192</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a2">updateStatus</a>() {
00193         <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a> != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00194             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().getEstimatedPosition();
00195             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().getEstimatedRotation();
00196             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r3">moving</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().isMoving();
00197             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r4">rotating</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().isRotating();
00198             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r6">measuring</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a2">getMagnetometer</a>().isMeasuring();
00199             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r5">demagnetizing</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a0">getDegausser</a>().isDemagnetizing();
00200         }
00201 <span class="comment">//        statusAnimator.gone();</span>
00202         repaint();
00203     }
00204 
<a name="l00208"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a3">00208</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a3">measurementUpdated</a>(<a class="code" href="classikayaki_1_1_measurement_event.html">MeasurementEvent</a> e) {
00209         <span class="comment">// null means handler positions might have changed</span>
00210         <span class="keywordflow">if</span> (e == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d0">updatePositions</a>();
00211 
00212         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#a2">updateStatus</a>();
00213 
00214         <span class="comment">// TODO: is this needed?</span>
00215         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#q0">manualControlsPanel</a>.<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a1">setEnabled</a>();
00216     }
00217 
<a name="l00223"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#b0">00223</a>     <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#b0">paintComponent</a>(Graphics g) {
00224         <span class="comment">// must update radiobuttons' positions here, hope it's safe...</span>
00225         <span class="comment">// TODO: what would be the right place for this call?</span>
00226         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d1">updateButtonPositions</a>();
00227 
00228         <span class="comment">// let Swing erase the background</span>
00229         super.paintComponent(g);
00230 
00231         <span class="comment">// use more sophisticated drawing methods</span>
00232         Graphics2D g2 = (Graphics2D) g.create();
00233         g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
00234         g2.setStroke(<span class="keyword">new</span> BasicStroke(2));
00235         Color saved = g2.getColor();
00236 
00237         <span class="comment">// save our width and height to be handly available</span>
00238         <span class="keywordtype">int</span> w = getWidth();
00239         <span class="keywordtype">int</span> h = getHeight();
00240 
00241         <span class="comment">// leave some space for move-radiobuttons</span>
00242         g2.translate(80, 0);
00243         w -= 100;
00244 
00245         <span class="comment">// sample handler base line x position</span>
00246         <span class="keywordtype">int</span> basex = w / 2;
00247 
00248         <span class="comment">// magnetometer boxes' y positions and widths</span>
00249         <span class="keywordtype">int</span> box1y = (int) ((long) h * <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r12">posDemagZ</a> / <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a>);
00250         <span class="keywordtype">int</span> box2y = (int) ((long) h * <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r14">posBG</a> / <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a>);
00251         <span class="keywordtype">int</span> box1w = w * 3 / 5;
00252         <span class="keywordtype">int</span> box2w = w * 4 / 5;
00253 
00254         <span class="comment">// "sample" width, height and depth, rotation arrow length</span>
00255         <span class="keywordtype">int</span> samplew = w / 3;
00256         <span class="keywordtype">int</span> sampleh = w / 4;
00257         <span class="keywordtype">int</span> sampled = h / 12;
00258         <span class="keywordtype">int</span> arrowlength = w / 6;
00259 
00260         <span class="comment">// sample y position</span>
00261         <span class="keywordtype">int</span> sampley = (int) ((long) h * <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a> / <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r7">maxposition</a>);
00262 
00263         <span class="comment">// do the drawing...</span>
00264 
00265         <span class="comment">// handler base line</span>
00266         g2.drawLine(basex, 24, basex, box1y);
00267         g2.setColor(Color.LIGHT_GRAY);
00268         g2.drawLine(basex, box1y, basex, h);
00269         g2.setColor(saved);
00270 
00271         <span class="comment">// magnetometer boxes</span>
00272         g2.drawRect(basex - box1w / 2, box1y, box1w, box2y - box1y);
00273         g2.drawRect(basex - box2w / 2, box2y, box2w, h - box2y - 2);
00274 
00275         <span class="comment">// "sample"</span>
00276         Color bg;
00277         <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r5">demagnetizing</a>) {
00278             bg = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s0">DEMAGNETIZING_COLOR</a>;
00279         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r6">measuring</a>) {
00280             bg = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s1">MEASURING_COLOR</a>;
00281         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r3">moving</a> || <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r4">rotating</a>) {
00282             bg = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s2">MOVING_COLOR</a>;
00283         } <span class="keywordflow">else</span> {
00284             bg = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#s3">IDLE_COLOR</a>;
00285         }
00286         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d2">drawFillOval</a>(g2, bg, basex - samplew / 2, sampley - sampled, samplew, sampleh);
00287         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d3">drawFillSideRect</a>(g2, bg, basex - samplew / 2, sampley - sampled + sampleh / 2, samplew, sampled);
00288         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d2">drawFillOval</a>(g2, bg, basex - samplew / 2, sampley, samplew, sampleh);
00289 
00290         <span class="comment">// sample rotation arrow</span>
00291         <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d4">drawArrow</a>(g2, basex, sampley + sampleh / 2, arrowlength, -<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a>);
00292 
00293         <span class="comment">// handler information</span>
00294         <span class="comment">//g2.setColor(Color.BLUE);</span>
00295         g2.drawString(<span class="stringliteral">"position: "</span> + <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a>, 0, 12);
00296         g2.drawString(<span class="stringliteral">"rotation: "</span> + <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a>, 0, 24);
00297 
00298         <span class="comment">// restore original Graphics</span>
00299         g2.dispose();
00300     }
00301 
<a name="l00305"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d2">00305</a>     <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d2">drawFillOval</a>(Graphics2D g2, Color fill, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height) {
00306         Color saved = g2.getColor();
00307         g2.setColor(fill);
00308         g2.fillOval(x, y, width, height);
00309         g2.setColor(saved);
00310         g2.drawOval(x, y, width, height);
00311     }
00312 
<a name="l00316"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d3">00316</a>     <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d3">drawFillSideRect</a>(Graphics2D g2, Color fill, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height) {
00317         Color saved = g2.getColor();
00318         g2.setColor(fill);
00319         g2.fillRect(x, y, width, height);
00320         g2.setColor(saved);
00321         g2.drawLine(x, y, x, y + height);
00322         g2.drawLine(x + width, y, x + width, y + height);
00323     }
00324 
<a name="l00334"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d4">00334</a>     <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#d4">drawArrow</a>(Graphics2D g2, <span class="keywordtype">int</span> x, <span class="keywordtype">int</span> y, <span class="keywordtype">int</span> length, <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a>) {
00335         <span class="keywordtype">double</span> rot = Math.PI * 2 * rotation / <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r8">maxrotation</a>;
00336         g2.translate(x, y);
00337         g2.rotate(rot);
00338         g2.drawLine(0, -length / 2, 0, length / 2);
00339         g2.drawLine(0, -length / 2, -length / 4, -length / 4);
00340         g2.drawLine(0, -length / 2, length / 4, -length / 4);
00341         g2.rotate(-rot);
00342         g2.translate(-x, -y);
00343     }
00344 
<a name="l00350"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html">00350</a>     <span class="keyword">private</span> <span class="keyword">class </span><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html">MagnetometerStatusAnimator</a> <span class="keyword">implements</span> Runnable {
00351         <span class="comment">// drawing delay in ms (fps = 1000 / delay)</span>
<a name="l00352"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r0">00352</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r0">updateDelay</a>;
00353 
00354         <span class="comment">// steps per second (normal and in measurement zone), rotation-angles per second</span>
<a name="l00355"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r1">00355</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r1">sps</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r2">msps</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r3">rps</a>;
00356 
00357         <span class="comment">// position &amp; rotation we're going from, amount and direction (+/-1)</span>
<a name="l00358"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r5">00358</a>         <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r4">posFrom</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r5">rotateFrom</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r6">posAmount</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r7">rotateAmount</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r8">posDirection</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r9">rotateDirection</a>;
00359 
<a name="l00360"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r10">00360</a>         <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r10">startTime</a>;
<a name="l00361"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">00361</a>         <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">going</a>;
00362 
<a name="l00363"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">00363</a>         <span class="keyword">private</span> Thread <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a>;
00364 
<a name="l00365"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a0">00365</a>         <span class="keyword">public</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a0">MagnetometerStatusAnimator</a>() {
00366             <span class="keyword">this</span>(50);
00367         }
00368 
<a name="l00369"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a1">00369</a>         <span class="keyword">public</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a0">MagnetometerStatusAnimator</a>(<span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r0">updateDelay</a>) {
00370             <span class="keyword">this</span>.sps = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerVelocity();
00371             <span class="keyword">this</span>.sps = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerMeasurementVelocity();
00372             <span class="keyword">this</span>.rps = <a class="code" href="classikayaki_1_1_settings.html">Settings</a>.getHandlerRotationVelocity();
00373             <span class="keyword">this</span>.updateDelay = updateDelay;
00374         }
00375 
<a name="l00381"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a2">00381</a>         <span class="keyword">synchronized</span> <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">going</a>(<span class="keywordtype">int</span> posTo, <span class="keywordtype">int</span> rotateTo) {
00382             <span class="keywordflow">if</span> (<span class="keyword">true</span>) {
00383                 <span class="keyword">this</span>.going = <span class="keyword">true</span>;
00384                 <span class="keywordflow">return</span>;
00385             }
00386 
00387             <span class="comment">// kill any running animator thread</span>
00388             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#d0">killAnimatorThread</a>();
00389 
00390             <span class="keyword">this</span>.posFrom = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a>;
00391             <span class="keyword">this</span>.rotateFrom = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a>;
00392 
00393             <span class="keyword">this</span>.posAmount = Math.abs(posTo - <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r4">posFrom</a>);
00394             <span class="keyword">this</span>.rotateAmount = Math.abs(rotateTo - <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r5">rotateFrom</a>);
00395             <span class="keyword">this</span>.posDirection = posTo &lt; <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r4">posFrom</a> ? -1 : 1;
00396             <span class="keyword">this</span>.rotateDirection = rotateTo &lt; <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r5">rotateFrom</a> ? -1 : 1;
00397 
00398             <span class="keyword">this</span>.startTime = System.currentTimeMillis();
00399             <span class="keyword">this</span>.going = <span class="keyword">true</span>;
00400 
00401             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a> = <span class="keyword">new</span> Thread(<span class="keyword">this</span>);
00402             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a>.setPriority(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a>.getPriority() - 1);
00403             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a>.start();
00404         }
00405 
<a name="l00409"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a3">00409</a>         <span class="keyword">synchronized</span> <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a3">gone</a>() {
00410             <span class="keywordflow">if</span> (<span class="keyword">true</span>) {
00411                 <span class="keyword">this</span>.going = <span class="keyword">false</span>;
00412                 <span class="keywordflow">return</span>;
00413             }
00414 
00415             <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a> != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00416                 <span class="keywordtype">long</span> time = System.currentTimeMillis() - <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r10">startTime</a>;
00417 
00418                 <span class="comment">// new speeds averaged with actual and guess</span>
00419                 <span class="keyword">this</span>.sps = ((int) (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r6">posAmount</a> * 1000L / time) + <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r1">sps</a>) / 2;
00420                 <span class="keyword">this</span>.rps = ((int) (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r7">rotateAmount</a> * 1000L / time) + <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r3">rps</a>) / 2;
00421 
00422                 <span class="comment">//System.out.println("animatorThread: sps " + sps + "  rps " + rps);</span>
00423             }
00424 
00425             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#d0">killAnimatorThread</a>();
00426         }
00427 
<a name="l00428"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#d0">00428</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#d0">killAnimatorThread</a>() {
00429             <span class="keyword">this</span>.going = <span class="keyword">false</span>;
00430             <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a> != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00431                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a>.interrupt();
00432                 <span class="keywordflow">try</span> {
00433                     <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a>.join();
00434                 } <span class="keywordflow">catch</span> (InterruptedException e) {
00435                 }
00436                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r12">animatorThread</a> = <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00437             }
00438         }
00439 
<a name="l00440"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a4">00440</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a4">run</a>() {
00441             <span class="keywordflow">while</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">going</a>) {
00442                 <span class="keywordflow">try</span> {
00443                     Thread.sleep(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r0">updateDelay</a>);
00444                 } <span class="keywordflow">catch</span> (InterruptedException e) {
00445                 }
00446 
00447                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().getEstimatedPosition();
00448                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().getEstimatedRotation();
00449 
00450                 <span class="comment">// TODO: this wouldn't actually be needed if we get MeasurementEvent every time</span>
00451                 <span class="comment">// handler stops, but let's just make sure :)</span>
00452                 <span class="keywordflow">if</span> (!<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r0">squid</a>.<a class="code" href="classikayaki_1_1squid_1_1_squid.html#a1">getHandler</a>().isMoving()) <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">going</a> = <span class="keyword">false</span>;
00453 
00454                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html">MagnetometerStatusPanel</a>.this.repaint();
00455             }
00456         }
00457 
<a name="l00461"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a5">00461</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#a5">run_old</a>() {
00462             <span class="keywordflow">while</span> (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">going</a>) {
00463                 <span class="keywordflow">try</span> {
00464                     Thread.sleep(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r0">updateDelay</a>);
00465                 } <span class="keywordflow">catch</span> (InterruptedException e) {
00466                 }
00467 
00468                 <span class="keywordflow">if</span> (!<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r11">going</a>) <span class="keywordflow">break</span>;
00469 
00470                 <span class="keywordtype">long</span> time = System.currentTimeMillis() - <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r10">startTime</a>;
00471 
00472                 <span class="comment">// TODO: different speed in measurement zone</span>
00473                 <span class="keywordtype">int</span> pos = (int) (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r1">sps</a> * time / 1000);
00474                 <span class="keywordtype">int</span> rotate = (int) (<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r3">rps</a> * time / 1000);
00475                 <span class="keywordflow">if</span> (pos &gt; <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r6">posAmount</a>) pos = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r6">posAmount</a>;
00476                 <span class="keywordflow">if</span> (rotate &gt; <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r7">rotateAmount</a>) rotate = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r7">rotateAmount</a>;
00477 
00478                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r1">position</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r4">posFrom</a> + pos * <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r8">posDirection</a>;
00479                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html#r2">rotation</a> = <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r5">rotateFrom</a> + rotate * <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r9">rotateDirection</a>;
00480 
00481                 <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel.html">MagnetometerStatusPanel</a>.this.repaint();
00482 
00483                 <span class="keywordflow">if</span> (pos == <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r6">posAmount</a> &amp;&amp; rotate == <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_magnetometer_status_animator.html#r7">rotateAmount</a>) <span class="keywordflow">break</span>;
00484             }
00485         }
00486     }
00487 
<a name="l00492"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html">00492</a>     <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html">ManualControlsPanel</a> <span class="keyword">extends</span> JPanel {
<a name="l00496"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r0">00496</a>         <span class="keyword">private</span> <a class="code" href="classikayaki_1_1_project.html">Project</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r0">project</a>;
00497 
<a name="l00501"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">00501</a>         <span class="keyword">private</span> <span class="keyword">final</span> ButtonGroup <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a> = <span class="keyword">new</span> ButtonGroup();
00502 
<a name="l00506"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">00506</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">moveLeft</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"Left limit"</span>);
00507 
<a name="l00511"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r3">00511</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r3">moveHome</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"Home"</span>);
00512 
<a name="l00516"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r4">00516</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r4">moveDemagZ</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"Demag Z"</span>);
00517 
<a name="l00521"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r5">00521</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r5">moveDemagY</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"Demag Y"</span>);
00522 
<a name="l00526"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r6">00526</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r6">moveBG</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"BG"</span>);
00527 
<a name="l00531"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r7">00531</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r7">moveMeasure</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"Measure"</span>);
00532 
<a name="l00536"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r8">00536</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r8">moveRight</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"Right limit"</span>);
00537 
<a name="l00541"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r9">00541</a>         <span class="keyword">private</span> <span class="keyword">final</span> ButtonGroup <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r9">rotateButtonGroup</a> = <span class="keyword">new</span> ButtonGroup();
00542 
<a name="l00546"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r10">00546</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r10">rotate0</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"0"</span>);
00547 
<a name="l00551"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r11">00551</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r11">rotate90</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"90"</span>);
00552 
<a name="l00556"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r12">00556</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r12">rotate180</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"180"</span>);
00557 
<a name="l00561"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r13">00561</a>         <span class="keyword">private</span> <span class="keyword">final</span> JRadioButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r13">rotate270</a> = <span class="keyword">new</span> JRadioButton(<span class="stringliteral">"270"</span>);
00562 
<a name="l00566"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r14">00566</a>         <span class="keyword">private</span> <span class="keyword">final</span> JButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r14">measureAllButton</a> = <span class="keyword">new</span> JButton();
<a name="l00567"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r15">00567</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r15">measureAllButtonFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r14">measureAllButton</a>);
<a name="l00568"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r16">00568</a>         <span class="keyword">private</span> <span class="keyword">final</span> String <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r16">measureAllButtonBaseText</a> = <span class="stringliteral">"Measure "</span>;
00569 
<a name="l00573"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r17">00573</a>         <span class="keyword">private</span> <span class="keyword">final</span> JButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r17">resetAllButton</a> = <span class="keyword">new</span> JButton(<span class="stringliteral">"Reset XYZ"</span>);
<a name="l00574"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r18">00574</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r18">resetAllButtonFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r17">resetAllButton</a>);
00575 
<a name="l00579"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r19">00579</a>         <span class="keyword">private</span> <span class="keyword">final</span> JButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r19">nextLineButton</a> = <span class="keyword">new</span> JButton(<span class="stringliteral">"Next line"</span>);
<a name="l00580"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r20">00580</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r20">nextLineButtonFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r19">nextLineButton</a>);
00581 
<a name="l00585"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r21">00585</a>         <span class="keyword">private</span> <span class="keyword">final</span> JTextField <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r21">demagAmplitudeField</a> = <span class="keyword">new</span> JTextField();
<a name="l00586"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r22">00586</a>         <span class="keyword">private</span> <span class="keyword">final</span> JLabel <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r22">demagAmplitudeLabel</a> = <span class="keyword">new</span> JLabel(<span class="stringliteral">"mT"</span>);
<a name="l00587"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r23">00587</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r23">demagAmplitudeFieldFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r21">demagAmplitudeField</a>);
00588 
<a name="l00592"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r24">00592</a>         <span class="keyword">private</span> <span class="keyword">final</span> JButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r24">demagButton</a> = <span class="keyword">new</span> JButton();
<a name="l00593"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r25">00593</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r25">demagButtonFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r24">demagButton</a>);
<a name="l00594"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r26">00594</a>         <span class="keyword">private</span> <span class="keyword">final</span> String <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r26">demagButtonBaseText</a> = <span class="stringliteral">"Demag "</span>;
<a name="l00595"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r27">00595</a>         <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r27">demagButtonIsY</a> = <span class="keyword">false</span>;
00596 
<a name="l00600"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r28">00600</a>         <span class="keyword">private</span> <span class="keyword">final</span> JButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r28">demagZButton</a> = <span class="keyword">new</span> JButton(<span class="stringliteral">"Demag in Z"</span>);
<a name="l00601"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r29">00601</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r29">demagZButtonFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r28">demagZButton</a>);
00602 
<a name="l00606"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r30">00606</a>         <span class="keyword">private</span> <span class="keyword">final</span> JButton <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r30">demagYButton</a> = <span class="keyword">new</span> JButton(<span class="stringliteral">"Demag in Y"</span>);
<a name="l00607"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r31">00607</a>         <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r31">demagYButtonFlasher</a> = <span class="keyword">new</span> <a class="code" href="classikayaki_1_1gui_1_1_component_flasher.html">ComponentFlasher</a>(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r30">demagYButton</a>);
00608 
00609         <span class="comment">// labels for command groups</span>
<a name="l00610"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">00610</a>         <span class="keyword">private</span> <span class="keyword">final</span> JLabel <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">moveLabel</a> = <span class="keyword">new</span> JLabel(<span class="stringliteral">"Move"</span>);
<a name="l00611"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r33">00611</a>         <span class="keyword">private</span> <span class="keyword">final</span> JLabel <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r33">rotateLabel</a> = <span class="keyword">new</span> JLabel(<span class="stringliteral">"Rotate"</span>);
<a name="l00612"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r34">00612</a>         <span class="keyword">private</span> <span class="keyword">final</span> JLabel <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r34">measureLabel</a> = <span class="keyword">new</span> JLabel(<span class="stringliteral">"Measure"</span>);
<a name="l00613"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r35">00613</a>         <span class="keyword">private</span> <span class="keyword">final</span> JLabel <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r35">demagLabel</a> = <span class="keyword">new</span> JLabel(<span class="stringliteral">"Demagnetize"</span>);
00614 
00615         <span class="comment">// don't say anything about this... well, it's like this 'cause the components are scattered all over</span>
<a name="l00616"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r36">00616</a>         <span class="keyword">private</span> <span class="keyword">final</span> Component[] <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r36">components</a> = <span class="keyword">new</span> Component[]{
00617             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">moveLeft</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r3">moveHome</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r4">moveDemagZ</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r5">moveDemagY</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r6">moveBG</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r7">moveMeasure</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r8">moveRight</a>,
00618             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r10">rotate0</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r11">rotate90</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r12">rotate180</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r13">rotate270</a>,
00619             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r14">measureAllButton</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r17">resetAllButton</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r19">nextLineButton</a>,
00620             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r21">demagAmplitudeField</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r22">demagAmplitudeLabel</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r24">demagButton</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r28">demagZButton</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r30">demagYButton</a>,
00621             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">moveLabel</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r33">rotateLabel</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r34">measureLabel</a>, <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r35">demagLabel</a>
00622         };
00623 
<a name="l00627"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a0">00627</a>         <span class="keyword">public</span> <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a0">ManualControlsPanel</a>() {
00628             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">moveLeft</a>);
00629             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r3">moveHome</a>);
00630             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r4">moveDemagZ</a>);
00631             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r5">moveDemagY</a>);
00632             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r6">moveBG</a>);
00633             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r7">moveMeasure</a>);
00634             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r1">moveButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r8">moveRight</a>);
00635 
00636             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r9">rotateButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r10">rotate0</a>);
00637             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r9">rotateButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r11">rotate90</a>);
00638             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r9">rotateButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r12">rotate180</a>);
00639             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r9">rotateButtonGroup</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r13">rotate270</a>);
00640 
00641             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">moveLabel</a>.setFont(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r32">moveLabel</a>.getFont().deriveFont(Font.BOLD));
00642             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r33">rotateLabel</a>.setFont(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r33">rotateLabel</a>.getFont().deriveFont(Font.BOLD));
00643             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r34">measureLabel</a>.setFont(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r34">measureLabel</a>.getFont().deriveFont(Font.BOLD));
00644             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r35">demagLabel</a>.setFont(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r35">demagLabel</a>.getFont().deriveFont(Font.BOLD));
00645 
00646             moveHome.setMargin(<span class="keyword">new</span> Insets(0, 0, 0, 0));
00647             moveDemagZ.setMargin(<span class="keyword">new</span> Insets(0, 0, 0, 0));
00648             moveDemagY.setMargin(<span class="keyword">new</span> Insets(0, 0, 0, 0));
00649             moveBG.setMargin(<span class="keyword">new</span> Insets(0, 0, 0, 0));
00650             moveMeasure.setMargin(<span class="keyword">new</span> Insets(0, 0, 0, 0));
00651 
00652             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r14">measureAllButton</a>.setMargin(<span class="keyword">new</span> Insets(1, 1, 1, 1));
00653             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r17">resetAllButton</a>.setMargin(<span class="keyword">new</span> Insets(1, 1, 1, 1));
00654             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r19">nextLineButton</a>.setMargin(<span class="keyword">new</span> Insets(1, 1, 1, 1));
00655             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r24">demagButton</a>.setMargin(<span class="keyword">new</span> Insets(1, 1, 1, 1));
00656             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r28">demagZButton</a>.setMargin(<span class="keyword">new</span> Insets(1, 1, 1, 1));
00657             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r30">demagYButton</a>.setMargin(<span class="keyword">new</span> Insets(1, 1, 1, 1));
00658 
00659             JPanel rotatePanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout());
00660             JPanel rotateButtonPanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout());
00661             rotate0.setHorizontalAlignment(JRadioButton.CENTER);
00662             rotate180.setHorizontalAlignment(JRadioButton.CENTER);
00663             rotateButtonPanel.add(rotate0, BorderLayout.NORTH);
00664             rotateButtonPanel.add(rotate90, BorderLayout.WEST);
00665             rotateButtonPanel.add(rotate180, BorderLayout.SOUTH);
00666             rotateButtonPanel.add(rotate270, BorderLayout.EAST);
00667             rotatePanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r33">rotateLabel</a>, BorderLayout.NORTH);
00668             rotatePanel.add(rotateButtonPanel, BorderLayout.CENTER);
00669 
00670             JPanel measurePanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout());
00671             JPanel measureButtonPanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> GridLayout(3, 1, 0, 4));
00672             measureButtonPanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r14">measureAllButton</a>);
00673             measureButtonPanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r17">resetAllButton</a>);
00674             measureButtonPanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r19">nextLineButton</a>);
00675             measurePanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r34">measureLabel</a>, BorderLayout.NORTH);
00676             measurePanel.add(measureButtonPanel, BorderLayout.CENTER);
00677 
00678             JPanel demagPanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout());
00679             JPanel demagButtonPanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> GridLayout(3, 1, 0, 4));
00680             JPanel demagAmplitudePanel = <span class="keyword">new</span> JPanel(<span class="keyword">new</span> BorderLayout(4, 0));
00681             demagAmplitudePanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r21">demagAmplitudeField</a>, BorderLayout.CENTER);
00682             demagAmplitudePanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r22">demagAmplitudeLabel</a>, BorderLayout.EAST);
00683             demagButtonPanel.add(demagAmplitudePanel);
00684             demagButtonPanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r24">demagButton</a>);
00685 <span class="comment">//            demagButtonPanel.add(demagZButton);</span>
00686 <span class="comment">//            demagButtonPanel.add(demagYButton);</span>
00687             demagPanel.add(<a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r35">demagLabel</a>, BorderLayout.NORTH);
00688             demagPanel.add(demagButtonPanel, BorderLayout.CENTER);
00689 
00690             setLayout(<span class="keyword">new</span> FlowLayout(FlowLayout.LEFT, 8, 0));
00691             add(rotatePanel);
00692             add(measurePanel);
00693             add(demagPanel);
00694 
00695             <span class="comment">//setPreferredSize(new Dimension(100, 400));</span>
00696             <span class="comment">//setMaximumSize(new Dimension(100, 400));</span>
00697 
00698             <span class="comment">/*</span>
00699 <span class="comment">             * Event A: On moveXXX click - call project.doManualMove(int) with clicked position.</span>
00700 <span class="comment">             * If false is returned, show small error message. Position values are found from Settings;</span>
00701 <span class="comment">             * demagZ is Settings.getAxialAFPosition() and</span>
00702 <span class="comment">             * demagY is Settings.getTransverseYAFPosition().</span>
00703 <span class="comment">             */</span>
00704 
00705             <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r2">moveLeft</a>.addActionListener(<span class="keyword">new</span> ActionListener() {
00706                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00707                     <a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#r0">project</a>.<a class="code" href="classikayaki_1_1_project.html#a68">doManualMoveLeftLimit</a>();
00708                 }
00709             });
00710 
00711             moveHome.addActionListener(<span class="keyword">new</span> ActionListener() {
00712                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00713                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMoveHome();
00714                 }
00715             });
00716 
00717             moveDemagZ.addActionListener(<span class="keyword">new</span> ActionListener() {
00718                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00719                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMoveDegausserZ();
00720                 }
00721             });
00722 
00723             moveDemagY.addActionListener(<span class="keyword">new</span> ActionListener() {
00724                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00725                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMoveDegausserY();
00726                 }
00727             });
00728 
00729             moveBG.addActionListener(<span class="keyword">new</span> ActionListener() {
00730                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00731                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMoveBackground();
00732                 }
00733             });
00734 
00735             moveMeasure.addActionListener(<span class="keyword">new</span> ActionListener() {
00736                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00737                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMoveMeasurement();
00738                 }
00739             });
00740 
00741             moveRight.addActionListener(<span class="keyword">new</span> ActionListener() {
00742                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00743                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMoveRightLimit();
00744                 }
00745             });
00746 
00747             <span class="comment">/*</span>
00748 <span class="comment">              * Event B: On rotateXXX click - call project.doManualRotate(int) with clicked angle. If</span>
00749 <span class="comment">              * false is returned, show small error message.</span>
00750 <span class="comment">              */</span>
00751 
00752             rotate0.addActionListener(<span class="keyword">new</span> ActionListener() {
00753                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00754                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualRotate(0);
00755                 }
00756             });
00757 
00758             rotate90.addActionListener(<span class="keyword">new</span> ActionListener() {
00759                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00760                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualRotate(90);
00761                 }
00762             });
00763 
00764             rotate180.addActionListener(<span class="keyword">new</span> ActionListener() {
00765                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00766                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualRotate(180);
00767                 }
00768             });
00769 
00770             rotate270.addActionListener(<span class="keyword">new</span> ActionListener() {
00771                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00772                     <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualRotate(270);
00773                 }
00774             });
00775 
00776             <span class="comment">/*</span>
00777 <span class="comment">             * Event C: On measureAllButton click - call project.doManualMeasure(). If false is returned,</span>
00778 <span class="comment">             * show small error message.</span>
00779 <span class="comment">             */</span>
00780             measureAllButton.addActionListener(<span class="keyword">new</span> ActionListener() {
00781                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00782                     <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualMeasure()) measureAllButtonFlasher.flash();
00783                 }
00784             });
00785 
00786             <span class="comment">/*</span>
00787 <span class="comment">             * Event D: On resetAllButton click - call project.doManualReset()? If false is returned,</span>
00788 <span class="comment">             * show small error message.</span>
00789 <span class="comment">             */</span>
00790             resetAllButton.addActionListener(<span class="keyword">new</span> ActionListener() {
00791                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00792                     <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualReset()) resetAllButtonFlasher.flash();
00793                 }
00794             });
00795 
00796             <span class="comment">/*</span>
00797 <span class="comment">             * Bonus Event: Move to next measurement line (done with these details).</span>
00798 <span class="comment">             */</span>
00799             nextLineButton.addActionListener(<span class="keyword">new</span> ActionListener() {
00800                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00801                     <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualStepDone()) nextLineButtonFlasher.flash();
00802                 }
00803             });
00804 
00805             <span class="comment">/*</span>
00806 <span class="comment">             * Event E&amp;F: On Demag?Button click - call project.doManualDemag?(double) with value</span>
00807 <span class="comment">             * from demagAmplitudeField. If false is returned, show small error message.</span>
00808 <span class="comment">             */</span>
00809             demagButton.addActionListener(<span class="keyword">new</span> ActionListener() {
00810                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00811                     <span class="keywordtype">double</span> amplitude = getDemagAmplitude();
00812                     <span class="keywordflow">if</span> (amplitude &lt; 0) {
00813                         demagAmplitudeFieldError();
00814                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (demagButtonIsY) {
00815                         <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualDemagY(amplitude)) demagButtonFlasher.flash();
00816                     } <span class="keywordflow">else</span> {
00817                         <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualDemagZ(amplitude)) demagButtonFlasher.flash();
00818                     }
00819                 }
00820             });
00821 
00822             <span class="comment">/*</span>
00823 <span class="comment">             * Event E: On DemagZButton click - call project.doManualDemagZ(double) with value</span>
00824 <span class="comment">             * from demagAmplitudeField. If false is returned, show small error message.</span>
00825 <span class="comment">             */</span>
00826             demagZButton.addActionListener(<span class="keyword">new</span> ActionListener() {
00827                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00828                     <span class="keywordtype">double</span> amplitude = getDemagAmplitude();
00829                     <span class="keywordflow">if</span> (amplitude &lt; 0) {
00830                         demagAmplitudeFieldError();
00831                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualDemagZ(amplitude)) demagZButtonFlasher.flash();
00832                 }
00833             });
00834 
00835             <span class="comment">/*</span>
00836 <span class="comment">             * Event F: On DemagYButton click - call project.doManualDemagY(double) with value</span>
00837 <span class="comment">             * from demagAmplitudeField. If false is returned, show small error message.</span>
00838 <span class="comment">             */</span>
00839             demagYButton.addActionListener(<span class="keyword">new</span> ActionListener() {
00840                 <span class="keyword">public</span> <span class="keywordtype">void</span> actionPerformed(ActionEvent e) {
00841                     <span class="keywordtype">double</span> amplitude = getDemagAmplitude();
00842                     <span class="keywordflow">if</span> (amplitude &lt; 0) {
00843                         demagAmplitudeFieldError();
00844                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.doManualDemagY(amplitude)) demagYButtonFlasher.flash();
00845                 }
00846             });
00847         }
00848 
<a name="l00854"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#d0">00854</a>         <span class="keyword">private</span> <span class="keywordtype">double</span> getDemagAmplitude() {
00855             <span class="keywordtype">double</span> amplitude;
00856             <span class="keywordflow">try</span> {
00857                 amplitude = Double.valueOf(demagAmplitudeField.getText());
00858             } <span class="keywordflow">catch</span> (NumberFormatException ex) {
00859                 amplitude = -1;
00860             }
00861 
00862             <span class="keywordflow">return</span> amplitude;
00863         }
00864 
<a name="l00868"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#d1">00868</a>         <span class="keyword">private</span> <span class="keywordtype">void</span> demagAmplitudeFieldError() {
00869             <span class="comment">//demagAmplitudeField.selectAll();</span>
00870             demagAmplitudeField.requestFocusInWindow();
00871             demagAmplitudeFieldFlasher.flash();
00872         }
00873 
<a name="l00880"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a1">00880</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> setEnabled(<span class="keywordtype">boolean</span> enabled) {
00881             super.setEnabled(enabled);
00882             <span class="keywordflow">if</span> (squid == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) enabled = <span class="keyword">false</span>;
00883             <span class="keywordflow">for</span> (Component component : components) component.setEnabled(enabled);
00884 
00885             <span class="comment">// set selected radioboxes and buttons according to current handler status</span>
00886 
00887             <span class="comment">// move-radiobuttons</span>
00888             <span class="keywordtype">int</span> currentPosition = 0;
00889             <span class="keywordflow">if</span> (squid != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00890                 currentPosition = squid.getHandler().getPosition();
00891             }
00892             <span class="keywordflow">if</span> (currentPosition == Integer.MIN_VALUE) {
00893                 moveLeft.setSelected(<span class="keyword">true</span>);
00894             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (currentPosition == Integer.MAX_VALUE) {
00895                 moveRight.setSelected(<span class="keyword">true</span>);
00896             } <span class="keywordflow">else</span> {
00897                 JComponent c = moveButtons.get(<span class="keyword">new</span> Integer(currentPosition));
00898                 <span class="keywordflow">if</span> (c != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> &amp;&amp; c instanceof JRadioButton) {
00899                     ((JRadioButton) c).setSelected(<span class="keyword">true</span>);
00900                 }
00901             }
00902 
00903             <span class="comment">// rotate-radiobuttons</span>
00904             <span class="keywordflow">switch</span> (rotation) {
00905             <span class="keywordflow">case</span> 0:
00906                 rotate0.setSelected(<span class="keyword">true</span>);
00907                 <span class="keywordflow">break</span>;
00908             <span class="keywordflow">case</span> 90:
00909                 rotate90.setSelected(<span class="keyword">true</span>);
00910                 <span class="keywordflow">break</span>;
00911             <span class="keywordflow">case</span> 180:
00912                 rotate180.setSelected(<span class="keyword">true</span>);
00913                 <span class="keywordflow">break</span>;
00914             <span class="keywordflow">case</span> 270:
00915                 rotate270.setSelected(<span class="keyword">true</span>);
00916                 <span class="keywordflow">break</span>;
00917             }
00918 
00919             <span class="comment">// measure-button text</span>
00920             <span class="keywordflow">if</span> (position == posMeasure) {
00921                 measureAllButton.setText(measureAllButtonBaseText + <span class="stringliteral">"XYZ"</span>);
00922             } <span class="keywordflow">else</span> {
00923                 measureAllButton.setText(measureAllButtonBaseText + <span class="stringliteral">"BG"</span>);
00924             }
00925 
00926             <span class="comment">// demag-button text and enabled status</span>
00927             demagButton.setEnabled(enabled &amp;&amp; <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a> != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> &amp;&amp; <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>.isDegaussingEnabled());
00928             <span class="keywordflow">if</span> (position == posDemagZ) {
00929                 demagButtonIsY = <span class="keyword">false</span>;
00930                 demagButton.setText(demagButtonBaseText + <span class="stringliteral">"Z"</span>);
00931             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (position == posDemagY) {
00932                 demagButtonIsY = <span class="keyword">true</span>;
00933                 <span class="keywordflow">switch</span> (rotation) {
00934                 <span class="keywordflow">case</span> 0:
00935                 <span class="keywordflow">case</span> 180:
00936                     demagButton.setText(demagButtonBaseText + <span class="stringliteral">"Y"</span>);
00937                     <span class="keywordflow">break</span>;
00938                 <span class="keywordflow">case</span> 90:
00939                 <span class="keywordflow">case</span> 270:
00940                     demagButton.setText(demagButtonBaseText + <span class="stringliteral">"X"</span>);
00941                     <span class="keywordflow">break</span>;
00942                 }
00943             } <span class="keywordflow">else</span> {
00944                 demagButton.setText(demagButtonBaseText);
00945                 demagButton.setEnabled(<span class="keyword">false</span>);
00946             }
00947         }
00948 
<a name="l00952"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a2">00952</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> setEnabled() {
00953             setProject(<span class="keyword">this</span>.<a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>);
00954         }
00955 
<a name="l00961"></a><a class="code" href="classikayaki_1_1gui_1_1_magnetometer_status_panel_1_1_manual_controls_panel.html#a3">00961</a>         <span class="keyword">public</span> <span class="keywordtype">void</span> setProject(<a class="code" href="classikayaki_1_1_project.html">Project</a> <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a>) {
00962             <span class="keyword">this</span>.project = project;
00963 
00964             <span class="keywordflow">if</span> (<span class="keyword">this</span>.project == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00965                 setEnabled(<span class="keyword">false</span>);
00966             } <span class="keywordflow">else</span> {
00967                 setEnabled(project.<a class="code" href="classikayaki_1_1_project.html#a53">isManualControlEnabled</a>());
00968             }
00969         }
00970     }
00971 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed May 4 13:11:03 2005 for Squid by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
