<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Squid: My Documents/squid/src/ikayaki/gui/StereoPlot.java Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">My Documents</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">squid</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">ikayaki</a>&nbsp;/&nbsp;<a class="el" href="dir_000004.html">gui</a></div>
<h1>StereoPlot.java</h1><a href="_stereo_plot_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * StereoPlot.java</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Copyright (C) 2005 Project SQUID, http://www.cs.helsinki.fi/group/squid/</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * This file is part of Ikayaki.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * Ikayaki is free software; you can redistribute it and/or modify</span>
00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00011 <span class="comment"> * (at your option) any later version.</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * Ikayaki is distributed in the hope that it will be useful,</span>
00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
00016 <span class="comment"> * GNU General Public License for more details.</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00019 <span class="comment"> * along with Ikayaki; if not, write to the Free Software</span>
00020 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
00021 <span class="comment"> */</span>
00022 
00023 <span class="keyword">package </span>ikayaki.gui;
00024 
00025 <span class="keyword">import</span> ikayaki.MeasurementStep;
00026 <span class="keyword">import</span> ikayaki.MeasurementValue;
00027 <span class="keyword">import</span> ikayaki.Project;
00028 
00029 <span class="keyword">import</span> java.awt.*;
00030 <span class="keyword">import</span> java.awt.geom.Point2D;
00031 <span class="keyword">import</span> java.util.Vector;
00032 
00033 
<a name="l00039"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html">00039</a> <span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html">StereoPlot</a> <span class="keyword">extends</span> <a class="code" href="classikayaki_1_1gui_1_1_abstract_plot.html">AbstractPlot</a> {
00040 
<a name="l00044"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">00044</a>     <span class="keyword">private</span> Vector&lt;Point2D&gt; <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a> = <span class="keyword">new</span> Vector&lt;Point2D&gt;();
00045 
<a name="l00049"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r1">00049</a>     <span class="keyword">private</span> Vector&lt;Boolean&gt; <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r1">incSign</a> = <span class="keyword">new</span> Vector&lt;Boolean&gt;();
00050 
<a name="l00051"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r2">00051</a>     <span class="keyword">private</span> <a class="code" href="classikayaki_1_1_project.html">Project</a> <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r2">project</a> = <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00052 
<a name="l00053"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a0">00053</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a0">add</a>(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00054         <span class="keywordflow">if</span> (step.<a class="code" href="classikayaki_1_1_measurement_step.html#a6">getProject</a>() != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00055             <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r2">project</a> = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a6">getProject</a>();
00056         }
00057         Double incValue = MeasurementValue.INCLINATION.getValue(step);
00058         Double decValue = MeasurementValue.DECLINATION.getValue(step);
00059 
00060         <span class="keywordflow">if</span> (incValue != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> &amp;&amp; decValue != <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00061             <span class="keywordflow">if</span> (incValue.doubleValue() &gt;= 0) {
00062                 <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(decValue, incValue));
00063                 <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r1">incSign</a>.add(<span class="keyword">new</span> Boolean(<span class="keyword">true</span>));
00064             } <span class="keywordflow">else</span> {
00065                 <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.add(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(decValue, incValue));
00066                 <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r1">incSign</a>.add(<span class="keyword">new</span> Boolean(<span class="keyword">false</span>));
00067             }
00068         }
00069     }
00070 
<a name="l00071"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">00071</a>     <span class="keyword">private</span> Point2D.Double <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(Double decValue, Double incValue) {
00072         <span class="keywordtype">double</span> inc = Math.toRadians(incValue);
00073         <span class="keywordtype">double</span> dec = Math.toRadians(decValue);
00074         <span class="keywordtype">double</span> x = 0.5 + ((0.5 - (0.5 / (Math.PI / 2.0)) * Math.abs(inc)) * Math.cos(dec - (Math.PI / 2.0)));
00075         <span class="keywordtype">double</span> y = 0.5 + ((0.5 - (0.5 / (Math.PI / 2.0)) * Math.abs(inc)) * Math.sin(dec + (Math.PI / 2.0)));
00076         <span class="keywordflow">return</span> <span class="keyword">new</span> Point2D.Double(x, y);
00077     }
00078 
<a name="l00079"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a1">00079</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a1">reset</a>() {
00080         <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.clear();
00081         <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r1">incSign</a>.clear();
00082         repaint();
00083     }
00084 
<a name="l00085"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a2">00085</a>     <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a2">getNumMeasurements</a>() {
00086         <span class="keywordflow">return</span> <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.size();
00087     }
00088 
<a name="l00089"></a><a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a3">00089</a>     <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#a3">render</a>(<span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h, Graphics2D g2) {
00090         <span class="comment">// margin</span>
00091         <span class="keywordtype">int</span> m = 5;
00092         <span class="comment">// area for texts on edges</span>
00093         <span class="keywordtype">int</span> txtArea = 10;
00094         <span class="comment">// minimum of w and h</span>
00095         <span class="keywordtype">int</span> dim = Math.min(w, h);
00096         <span class="comment">// area for points in x and y direction = width = height of the actual plot</span>
00097         <span class="keywordtype">int</span> area = dim - (2 * (m + txtArea));
00098         <span class="comment">// font for texts</span>
00099         g2.setFont(<span class="keyword">new</span> Font(<span class="stringliteral">"Arial"</span>, Font.PLAIN, 8 + (area / 60)));
00100         FontMetrics metrics = g2.getFontMetrics();
00101         <span class="keywordtype">int</span> txtW = metrics.stringWidth(<span class="stringliteral">"N"</span>);
00102         <span class="keywordtype">int</span> txtH = metrics.getHeight();
00103 
00104         <span class="comment">// draw circle</span>
00105         g2.drawOval(m + txtArea, m + txtArea, area, area);
00106         <span class="comment">// draw ticks</span>
00107         <span class="keywordtype">int</span> tLength = 5; <span class="comment">// circle ticks length in degrees</span>
00108         <span class="keywordtype">int</span> atLength = (area / 40) + 3; <span class="comment">// horizontal and vertical ticks length</span>
00109 
00110         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 360; i = i + 10) {
00111             <span class="keywordtype">int</span> x1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(i), <span class="keyword">new</span> Double(0)).getX() * area).intValue();
00112             <span class="keywordtype">int</span> y1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(i), <span class="keyword">new</span> Double(0)).getY() * area).intValue();
00113             <span class="keywordtype">int</span> x2, y2;
00114             <span class="keywordflow">if</span> (i % 90 == 0) {
00115                 x2 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(i), <span class="keyword">new</span> Double(tLength * 2)).getX() * area).intValue();
00116                 y2 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(i), <span class="keyword">new</span> Double(tLength * 2)).getY() * area).intValue();
00117             } <span class="keywordflow">else</span> {
00118                 x2 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(i), <span class="keyword">new</span> Double(tLength)).getX() * area).intValue();
00119                 y2 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(i), <span class="keyword">new</span> Double(tLength)).getY() * area).intValue();
00120             }
00121             g2.drawLine((m + txtArea) + x1, (m + txtArea) + y1, (m + txtArea) + x2, (m + txtArea) + y2);
00122         }
00123 
00124         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 10; i &lt;= 90; i = i + 10) {
00125             <span class="keywordtype">int</span> x1, y1, x2, y2;
00126             x1 = (<span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(0), <span class="keyword">new</span> Double(i)).getX() * area).intValue()) - (atLength / 2);
00127             y1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(0), <span class="keyword">new</span> Double(i)).getY() * area).intValue();
00128             x2 = x1 + atLength;
00129             y2 = y1;
00130             g2.drawLine((m + txtArea) + x1, (m + txtArea) + y1, (m + txtArea) + x2, (m + txtArea) + y2);
00131         }
00132         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 10; i &lt;= 90; i = i + 10) {
00133             <span class="keywordtype">int</span> x1, y1, x2, y2;
00134             x1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(90), <span class="keyword">new</span> Double(i)).getX() * area).intValue();
00135             y1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(90), <span class="keyword">new</span> Double(i)).getY() * area).intValue() - (atLength / 2);
00136             x2 = x1;
00137             y2 = y1 + atLength;
00138             g2.drawLine((m + txtArea) + x1, (m + txtArea) + y1, (m + txtArea) + x2, (m + txtArea) + y2);
00139         }
00140         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 10; i &lt;= 90; i = i + 10) {
00141             <span class="keywordtype">int</span> x1, y1, x2, y2;
00142             x1 = (<span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(180), <span class="keyword">new</span> Double(i)).getX() * area).intValue()) - (atLength / 2);
00143             y1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(180), <span class="keyword">new</span> Double(i)).getY() * area).intValue();
00144             x2 = x1 + atLength;
00145             y2 = y1;
00146             g2.drawLine((m + txtArea) + x1, (m + txtArea) + y1, (m + txtArea) + x2, (m + txtArea) + y2);
00147         }
00148         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 10; i &lt;= 90; i = i + 10) {
00149             <span class="keywordtype">int</span> x1, y1, x2, y2;
00150             x1 = <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(270), <span class="keyword">new</span> Double(i)).getX() * area).intValue();
00151             y1 = (<span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#d0">toXY</a>(<span class="keyword">new</span> Double(270), <span class="keyword">new</span> Double(i)).getY() * area).intValue() - (atLength / 2));
00152             x2 = x1;
00153             y2 = y1 + atLength;
00154             g2.drawLine((m + txtArea) + x1, (m + txtArea) + y1, (m + txtArea) + x2, (m + txtArea) + y2);
00155         }
00156 
00157 
00158         <span class="comment">// draw symbols</span>
00159         g2.drawString(<span class="stringliteral">"N"</span>, m + txtArea + (area / 2) - (txtW / 2), m + (txtArea / 2) + (txtH / 2));
00160         g2.drawString(<span class="stringliteral">"W"</span>, m + txtArea / 2 - (txtW / 2), m + txtArea + (area / 2) + (txtH / 2));
00161         g2.drawString(<span class="stringliteral">"E"</span>, m + txtArea + area + (txtArea / 2) - (txtW / 2), m + txtArea + (area / 2) + (txtH / 2));
00162         g2.drawString(<span class="stringliteral">"S"</span>, m + txtArea + (area / 2) - (txtW / 2), m + txtArea + area + (txtArea / 2) + (txtH / 2));
00163 
00164         <span class="comment">// draw points</span>
00165         <span class="keywordtype">int</span> ps = (area / 60) + 4; <span class="comment">// points size</span>
00166         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.size(); i++) {
00167             <span class="keywordtype">int</span> x = (m + txtArea) + <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.elementAt(i).getX() * area).intValue();
00168             <span class="keywordtype">int</span> y = (m + txtArea) + area - <span class="keyword">new</span> Double(<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.elementAt(i).getY() * area).intValue();
00169             <span class="keywordflow">if</span> (i == 0) {
00170                 g2.drawString(<span class="stringliteral">"NRM"</span>, x + (area / 50), y - (area / 50));
00171             }
00172 
00173             <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r1">incSign</a>.elementAt(i).booleanValue()) { <span class="comment">// positive inclination</span>
00174                 g2.fillOval(x - (ps / 2), y - (ps / 2), ps, ps);
00175             } <span class="keywordflow">else</span> { <span class="comment">// negative inclination</span>
00176                 g2.drawOval(x - (ps / 2), y - (ps / 2), ps, ps);
00177             }
00178         }
00179 
00180         <span class="comment">// draw lines</span>
00181         <span class="keywordflow">if</span> (<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.size() &gt;= 2) {
00182             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; <a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.size(); i++) {
00183                 <span class="keywordtype">int</span> x1 = <span class="keyword">new</span> Double((<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.elementAt(i - 1).getX() * area)).intValue();
00184                 <span class="keywordtype">int</span> y1 = <span class="keyword">new</span> Double((<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.elementAt(i - 1).getY() * area)).intValue();
00185                 <span class="keywordtype">int</span> x2 = <span class="keyword">new</span> Double((<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.elementAt(i).getX() * area)).intValue();
00186                 <span class="keywordtype">int</span> y2 = <span class="keyword">new</span> Double((<a class="code" href="classikayaki_1_1gui_1_1_stereo_plot.html#r0">points</a>.elementAt(i).getY() * area)).intValue();
00187 
00188                 g2.drawLine((m + txtArea) + x1, (m + txtArea) + area - y1, (m + txtArea) + x2,
00189                         (m + txtArea) + area - y2);
00190             }
00191         }
00192     }
00193 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed May 4 13:11:04 2005 for Squid by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
