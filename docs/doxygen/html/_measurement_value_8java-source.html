<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Squid: My Documents/squid/src/ikayaki/MeasurementValue.java Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Packages</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">My Documents</a>&nbsp;/&nbsp;<a class="el" href="dir_000001.html">squid</a>&nbsp;/&nbsp;<a class="el" href="dir_000002.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000003.html">ikayaki</a></div>
<h1>MeasurementValue.java</h1><a href="_measurement_value_8java.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 <span class="comment">/*</span>
00002 <span class="comment"> * MeasurementValue.java</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Copyright (C) 2005 Project SQUID, http://www.cs.helsinki.fi/group/squid/</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> * This file is part of Ikayaki.</span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> * Ikayaki is free software; you can redistribute it and/or modify</span>
00009 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00010 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00011 <span class="comment"> * (at your option) any later version.</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * Ikayaki is distributed in the hope that it will be useful,</span>
00014 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00015 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
00016 <span class="comment"> * GNU General Public License for more details.</span>
00017 <span class="comment"> *</span>
00018 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00019 <span class="comment"> * along with Ikayaki; if not, write to the Free Software</span>
00020 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA</span>
00021 <span class="comment"> */</span>
00022 
00023 <span class="keyword">package </span>ikayaki;
00024 
00025 <span class="keyword">import</span> <span class="keyword">static</span> ikayaki.MeasurementResult.Type.*;
00026 <span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.atan2;
00027 <span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.PI;
00028 <span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.atan;
00029 <span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.pow;
00030 <span class="keyword">import</span> <span class="keyword">static</span> java.lang.Math.sqrt;
00031 
<a name="l00038"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html">00038</a> <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class </span>MeasurementValue &lt;T&gt; {
00039 
<a name="l00043"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s0">00043</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a19">GEOGRAPHIC_X</a> =
00044             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"X'"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Mean X (geographic coordinates)"</span>) {
00045                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00046                     <span class="keywordtype">double</span> sum = 0.0;
00047                     <span class="keywordtype">int</span> count = 0;
00048                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.<a class="code" href="classikayaki_1_1_measurement_step.html#a17">getResults</a>(); i++) {
00049                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a18">getResult</a>(i);
00050                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00051                             <span class="keywordflow">continue</span>;
00052                         }
00053                         sum += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a5">getGeographicX</a>();
00054                         count++;
00055                     }
00056                     <span class="keywordflow">if</span> (count &gt; 0) {
00057                         <span class="keywordflow">return</span> <span class="keyword">new</span> Double(sum / count);
00058                     } <span class="keywordflow">else</span> {
00059                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00060                     }
00061                 }
00062             };
00063 
<a name="l00067"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s1">00067</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a20">GEOGRAPHIC_X_NORMALIZED</a> =
00068             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"X'"</span>, <span class="stringliteral">"mA/m"</span>, <span class="stringliteral">"Normalized mean X (geographic coordinates)"</span>) {
00069                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00070                     <a class="code" href="classikayaki_1_1_project.html">Project</a> <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a> = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a6">getProject</a>();
00071                     <span class="keywordflow">if</span> (project == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00072                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00073                     }
00074 
00075                     <span class="keywordtype">double</span> normalizer;
00076                     <span class="keywordflow">if</span> (project.<a class="code" href="classikayaki_1_1_project.html#a27">getNormalization</a>() == <a class="code" href="classikayaki_1_1_project.html">Project</a>.Normalization.VOLUME) {
00077                         normalizer = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a13">getVolume</a>();
00078                         <span class="keywordflow">if</span> (normalizer &lt; 0.0) {
00079                             normalizer = project.<a class="code" href="classikayaki_1_1_project.html#a31">getVolume</a>();
00080                         }
00081                         normalizer = normalizer / 1000000.0;    <span class="comment">// convert cm^3 to m^3</span>
00082 
00083                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (project.<a class="code" href="classikayaki_1_1_project.html#a27">getNormalization</a>() == <a class="code" href="classikayaki_1_1_project.html">Project</a>.Normalization.MASS) {
00084                         normalizer = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a11">getMass</a>();
00085                         <span class="keywordflow">if</span> (normalizer &lt; 0.0) {
00086                             normalizer = project.<a class="code" href="classikayaki_1_1_project.html#a29">getMass</a>();
00087                         }
00088                         normalizer = normalizer / 1000.0;   <span class="comment">// convert g to kg</span>
00089 
00090                     } <span class="keywordflow">else</span> {
00091                         assert <span class="keyword">false</span>;
00092                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00093                     }
00094                     <span class="keywordflow">if</span> (normalizer &lt;= 0.0) {
00095                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00096                     }
00097 
00098                     Double <a class="code" href="namespaceikayaki_1_1gui.html#a26a3">value</a> = <a class="code" href="namespaceikayaki_1_1gui.html#a26a19">GEOGRAPHIC_X</a>.getValue(step);
00099                     <span class="keywordflow">if</span> (value == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00100                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00101                     } <span class="keywordflow">else</span> {
00102                         <span class="keywordflow">return</span> (value * 1000.0) / normalizer;      <span class="comment">// convert Am^2 to mAm^2</span>
00103                     }
00104                 }
00105             };
00106 
<a name="l00110"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s2">00110</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a21">GEOGRAPHIC_Y</a> =
00111             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"Y'"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Mean Y (geographic coordinates)"</span>) {
00112                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00113                     <span class="keywordtype">double</span> sum = 0.0;
00114                     <span class="keywordtype">int</span> count = 0;
00115                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.getResults(); i++) {
00116                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.getResult(i);
00117                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00118                             <span class="keywordflow">continue</span>;
00119                         }
00120                         sum += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a6">getGeographicY</a>();
00121                         count++;
00122                     }
00123                     <span class="keywordflow">if</span> (count &gt; 0) {
00124                         <span class="keywordflow">return</span> <span class="keyword">new</span> Double(sum / count);
00125                     } <span class="keywordflow">else</span> {
00126                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00127                     }
00128                 }
00129             };
00130 
<a name="l00134"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s3">00134</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a22">GEOGRAPHIC_Z</a> =
00135             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"Z'"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Mean Z (geographic coordinates)"</span>) {
00136                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00137                     <span class="keywordtype">double</span> sum = 0.0;
00138                     <span class="keywordtype">int</span> count = 0;
00139                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.<a class="code" href="classikayaki_1_1_measurement_step.html#a17">getResults</a>(); i++) {
00140                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a18">getResult</a>(i);
00141                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00142                             <span class="keywordflow">continue</span>;
00143                         }
00144                         sum += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a7">getGeographicZ</a>();
00145                         count++;
00146                     }
00147                     <span class="keywordflow">if</span> (count &gt; 0) {
00148                         <span class="keywordflow">return</span> <span class="keyword">new</span> Double(sum / count);
00149                     } <span class="keywordflow">else</span> {
00150                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00151                     }
00152                 }
00153             };
00154 
<a name="l00158"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s4">00158</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a23">SAMPLE_X</a> =
00159             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"X"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Mean X (sample coordinates)"</span>) {
00160                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00161                     <span class="keywordtype">double</span> sum = 0.0;
00162                     <span class="keywordtype">int</span> count = 0;
00163                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.<a class="code" href="classikayaki_1_1_measurement_step.html#a17">getResults</a>(); i++) {
00164                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a18">getResult</a>(i);
00165                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00166                             <span class="keywordflow">continue</span>;
00167                         }
00168                         sum += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a8">getSampleX</a>();
00169                         count++;
00170                     }
00171                     <span class="keywordflow">if</span> (count &gt; 0) {
00172                         <span class="keywordflow">return</span> <span class="keyword">new</span> Double(sum / count);
00173                     } <span class="keywordflow">else</span> {
00174                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00175                     }
00176                 }
00177             };
00178 
<a name="l00182"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s5">00182</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a24">SAMPLE_Y</a> =
00183             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"Y"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Mean Y (sample coordinates)"</span>) {
00184                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00185                     <span class="keywordtype">double</span> sum = 0.0;
00186                     <span class="keywordtype">int</span> count = 0;
00187                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.<a class="code" href="classikayaki_1_1_measurement_step.html#a17">getResults</a>(); i++) {
00188                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a18">getResult</a>(i);
00189                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00190                             <span class="keywordflow">continue</span>;
00191                         }
00192                         sum += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a9">getSampleY</a>();
00193                         count++;
00194                     }
00195                     <span class="keywordflow">if</span> (count &gt; 0) {
00196                         <span class="keywordflow">return</span> <span class="keyword">new</span> Double(sum / count);
00197                     } <span class="keywordflow">else</span> {
00198                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00199                     }
00200                 }
00201             };
00202 
<a name="l00206"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s6">00206</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; SAMPLE_Z =
00207             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"Z"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Mean Z (sample coordinates)"</span>) {
00208                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00209                     <span class="keywordtype">double</span> sum = 0.0;
00210                     <span class="keywordtype">int</span> count = 0;
00211                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.<a class="code" href="classikayaki_1_1_measurement_step.html#a17">getResults</a>(); i++) {
00212                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a18">getResult</a>(i);
00213                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00214                             <span class="keywordflow">continue</span>;
00215                         }
00216                         sum += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a10">getSampleZ</a>();
00217                         count++;
00218                     }
00219                     <span class="keywordflow">if</span> (count &gt; 0) {
00220                         <span class="keywordflow">return</span> <span class="keyword">new</span> Double(sum / count);
00221                     } <span class="keywordflow">else</span> {
00222                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00223                     }
00224                 }
00225             };
00226 
<a name="l00230"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s7">00230</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a13">DECLINATION</a> =
00231             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"D"</span>, <span class="stringliteral">"\u00b0"</span>, <span class="stringliteral">"Geographic declination"</span>) {
00232                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00233                     Double x = <a class="code" href="namespaceikayaki_1_1gui.html#a26a19">GEOGRAPHIC_X</a>.getValue(step);
00234                     Double y = <a class="code" href="namespaceikayaki_1_1gui.html#a26a21">GEOGRAPHIC_Y</a>.getValue(step);
00235                     <span class="keywordflow">if</span> (x == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || y == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00236                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00237                     } <span class="keywordflow">else</span> {
00238                         <span class="keywordtype">double</span> d = atan2(y, x);
00239                         <span class="keywordflow">if</span> (d &lt; 0.0) {
00240                             d += PI * 2;
00241                         }
00242                         <span class="keywordflow">return</span> Math.toDegrees(d);
00243                     }
00244                 }
00245             };
00246 
<a name="l00250"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s8">00250</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a14">INCLINATION</a> =
00251             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"I"</span>, <span class="stringliteral">"\u00b0"</span>, <span class="stringliteral">"Geographic inclination"</span>) {
00252                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00253                     Double x = <a class="code" href="namespaceikayaki_1_1gui.html#a26a19">GEOGRAPHIC_X</a>.getValue(step);
00254                     Double y = <a class="code" href="namespaceikayaki_1_1gui.html#a26a21">GEOGRAPHIC_Y</a>.getValue(step);
00255                     Double z = <a class="code" href="namespaceikayaki_1_1gui.html#a26a22">GEOGRAPHIC_Z</a>.getValue(step);
00256                     <span class="keywordflow">if</span> (x == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || y == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || z == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00257                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00258                     } <span class="keywordflow">else</span> {
00259                         <span class="keywordflow">if</span> (x == 0.0) {
00260                             x = 0.000000000001;
00261                         }
00262                         <span class="keywordflow">if</span> (y == 0.0) {
00263                             y = 0.000000000001;
00264                         }
00265                         <span class="keywordtype">double</span> d = atan(z / sqrt(pow(x, 2) + pow(y, 2)));
00266                         <span class="keywordflow">return</span> Math.toDegrees(d);
00267                     }
00268                 }
00269             };
00270 
<a name="l00274"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s9">00274</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a18">MOMENT</a> =
00275             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"M"</span>, <span class="stringliteral">"Am\u00B2"</span>, <span class="stringliteral">"Magnetic moment"</span>) {
00276                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00277                     Double x = <a class="code" href="namespaceikayaki_1_1gui.html#a26a23">SAMPLE_X</a>.getValue(step);
00278                     Double y = <a class="code" href="namespaceikayaki_1_1gui.html#a26a24">SAMPLE_Y</a>.getValue(step);
00279                     Double z = SAMPLE_Z.getValue(step);
00280                     <span class="keywordflow">if</span> (x == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || y == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || z == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00281                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00282                     } <span class="keywordflow">else</span> {
00283                         <span class="keywordflow">return</span> sqrt(pow(x, 2) + pow(y, 2) + pow(z, 2));
00284                     }
00285                 }
00286             };
00287 
<a name="l00292"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s10">00292</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a15">MAGNETIZATION</a> =
00293             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"J"</span>, <span class="stringliteral">"mA/m,Am\u00B2/kg"</span>, <span class="stringliteral">"Magnetic intensity"</span>) { <span class="comment">// J=M/volume or J=M/mass</span>
00294                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00295                     <a class="code" href="classikayaki_1_1_project.html">Project</a> <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a> = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a6">getProject</a>();
00296                     <span class="keywordflow">if</span> (project == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00297                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00298                     }
00299 
00300                     <span class="keywordtype">double</span> normalizer;
00301                     <span class="keywordflow">if</span> (project.<a class="code" href="classikayaki_1_1_project.html#a27">getNormalization</a>() == <a class="code" href="classikayaki_1_1_project.html">Project</a>.Normalization.VOLUME) {
00302                         normalizer = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a13">getVolume</a>();
00303                         <span class="keywordflow">if</span> (normalizer &lt; 0.0) {
00304                             normalizer = project.<a class="code" href="classikayaki_1_1_project.html#a31">getVolume</a>();
00305                         }
00306                         normalizer = normalizer / 1000000.0;    <span class="comment">// convert cm^3 to m^3</span>
00307 
00308                     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (project.<a class="code" href="classikayaki_1_1_project.html#a27">getNormalization</a>() == <a class="code" href="classikayaki_1_1_project.html">Project</a>.Normalization.MASS) {
00309                         normalizer = step.<a class="code" href="classikayaki_1_1_measurement_step.html#a11">getMass</a>();
00310                         <span class="keywordflow">if</span> (normalizer &lt; 0.0) {
00311                             normalizer = project.<a class="code" href="classikayaki_1_1_project.html#a29">getMass</a>();
00312                         }
00313                         normalizer = normalizer / 1000.0;   <span class="comment">// convert g to kg</span>
00314 
00315                     } <span class="keywordflow">else</span> {
00316                         assert <span class="keyword">false</span>;
00317                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00318                     }
00319                     <span class="keywordflow">if</span> (normalizer &lt;= 0.0) {
00320                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00321                     }
00322 
00323                     Double moment = <a class="code" href="namespaceikayaki_1_1gui.html#a26a18">MOMENT</a>.getValue(step);
00324                     <span class="keywordflow">if</span> (moment == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00325                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00326                     } <span class="keywordflow">else</span> {
00327                         <span class="keywordflow">return</span> (moment * 1000.0) / normalizer;      <span class="comment">// convert Am^2 to mAm^2</span>
00328                     }
00329                 }
00330             };
00331 
<a name="l00335"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s11">00335</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a16">RELATIVE_MAGNETIZATION</a> =
00336             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"J/Jo"</span>, <span class="stringliteral">""</span>, <span class="stringliteral">"Relative magnetic intensity"</span>) {
00337                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00338                     <a class="code" href="classikayaki_1_1_project.html">Project</a> <a class="code" href="namespaceikayaki_1_1gui.html#a26a1">project</a> = step.getProject();
00339                     <span class="keywordflow">if</span> (project == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00340                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00341                     }
00342                     Double j = <a class="code" href="namespaceikayaki_1_1gui.html#a26a15">MAGNETIZATION</a>.getValue(step);
00343                     Double j0 = <a class="code" href="namespaceikayaki_1_1gui.html#a26a15">MAGNETIZATION</a>.getValue(project.<a class="code" href="classikayaki_1_1_project.html#a48">getStep</a>(0));     <span class="comment">// there is at least one step in the project</span>
00344                     <span class="keywordflow">if</span> (j == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || j0 == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00345                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00346                     } <span class="keywordflow">else</span> {
00347                         <span class="keywordflow">return</span> j.doubleValue() / j0.doubleValue();
00348                     }
00349                 }
00350             };
00351 
<a name="l00355"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s12">00355</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; <a class="code" href="namespaceikayaki_1_1gui.html#a26a17">THETA63</a> =
00356             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"\u03b863"</span>, <span class="stringliteral">"\u00b0"</span>, <span class="stringliteral">"Angular standard deviation"</span>) {
00357                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00358                     <span class="keywordtype">int</span> count = 0;
00359                     <span class="keywordtype">double</span> sumX = 0.0;
00360                     <span class="keywordtype">double</span> sumY = 0.0;
00361                     <span class="keywordtype">double</span> sumZ = 0.0;
00362                     <span class="keywordtype">double</span> sumLength = 0.0;
00363 
00364                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; step.getResults(); i++) {
00365                         <a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r = step.getResult(i);
00366                         <span class="keywordflow">if</span> (r.<a class="code" href="classikayaki_1_1_measurement_result.html#a3">getType</a>() != SAMPLE) {
00367                             <span class="keywordflow">continue</span>;
00368                         }
00369                         <span class="comment">// TODO: should there be the full vectors, or normalized vectors (length=1)?</span>
00370                         sumX += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a8">getSampleX</a>();
00371                         sumY += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a9">getSampleY</a>();
00372                         sumZ += r.<a class="code" href="classikayaki_1_1_measurement_result.html#a10">getSampleZ</a>();
00373                         sumLength += r.<a class="code" href="classikayaki_1_1_measurement_result.html#b3">getSampleVector</a>().length();
00374                         count++;
00375                     }
00376                     <span class="keywordflow">if</span> (count &lt; 2) {
00377                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00378                     }
00379                     <span class="keywordtype">double</span> avgLength = sumLength / count;
00380 
00381                     <span class="keywordtype">double</span> N = sumLength;
00382                     <span class="keywordtype">double</span> R = sqrt((sumX * sumX) + (sumY * sumY) + (sumZ * sumZ));
00383                     <span class="keywordtype">double</span> k = (N - avgLength) / (N - R);
00384                     <span class="keywordflow">return</span> 81.0 / sqrt(k);
00385                 }
00386             };
00387 
<a name="l00391"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s13">00391</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; SIGNAL_TO_NOISE =
00392             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"caption"</span>, <span class="stringliteral">"unit"</span>, <span class="stringliteral">"description"</span>) {
00393                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00394                     <span class="keywordflow">if</span> (step == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00395                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00396                     }
00397 
00398                     <span class="comment">// compute the average length of the vectors</span>
00399                     <span class="keywordtype">int</span> count = 0;
00400                     <span class="keywordtype">double</span> lengthSum = 0.0;
00401                     <span class="keywordflow">for</span> (<a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r : step) {
00402                         lengthSum += r.getSampleVector().length();
00403                         count++;
00404                     }
00405                     <span class="keywordflow">if</span> (count &lt; 2) {
00406                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00407                     }
00408                     <span class="keywordtype">double</span> lengthAvg = lengthSum / count;
00409 
00410                     <span class="comment">// compute the standard deviation</span>
00411                     <span class="keywordtype">double</span> squareSum = 0.0;
00412                     <span class="keywordflow">for</span> (<a class="code" href="classikayaki_1_1_measurement_result.html">MeasurementResult</a> r : step) {
00413                         <span class="keywordtype">double</span> d = r.getSampleVector().length() - lengthAvg;
00414                         squareSum += (d * d);
00415                     }
00416                     <span class="keywordtype">double</span> stdev = Math.sqrt(squareSum / (count - 1));
00417 
00418                     <span class="keywordflow">return</span> lengthAvg / stdev;
00419                 }
00420             };
00421 
<a name="l00425"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s14">00425</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; SIGNAL_TO_DRIFT =
00426             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"caption"</span>, <span class="stringliteral">"unit"</span>, <span class="stringliteral">"description"</span>) {
00427                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00428                     <span class="keywordflow">if</span> (step == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00429                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00430                     }
00431                     Double signal = <a class="code" href="namespaceikayaki_1_1gui.html#a26a18">MOMENT</a>.getValue(step);
00432                     <span class="keywordflow">if</span> (signal == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00433                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00434                     }
00435                     <span class="keywordtype">double</span> d = step.getNoise().length();
00436                     <span class="keywordflow">if</span> (d == 0.0) {
00437                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00438                     }
00439                     <span class="keywordflow">return</span> signal.doubleValue() / d;
00440                 }
00441             };
00442 
<a name="l00446"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#s15">00446</a>     <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> MeasurementValue&lt;Double&gt; SIGNAL_TO_HOLDER =
00447             <span class="keyword">new</span> MeasurementValue&lt;Double&gt;(<span class="stringliteral">"caption"</span>, <span class="stringliteral">"unit"</span>, <span class="stringliteral">"description"</span>) {
00448                 <span class="keyword">public</span> Double getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step) {
00449                     <span class="keywordflow">if</span> (step == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00450                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00451                     }
00452                     Double signal = <a class="code" href="namespaceikayaki_1_1gui.html#a26a18">MOMENT</a>.getValue(step);
00453                     <span class="keywordflow">if</span> (signal == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00454                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00455                     }
00456                     <span class="keywordtype">double</span> d = step.getHolder().length();
00457                     <span class="keywordflow">if</span> (d == 0.0) {
00458                         <span class="keywordflow">return</span> <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>;
00459                     }
00460                     <span class="keywordflow">return</span> signal.doubleValue() / d;
00461                 }
00462             };
00463 
00464 
<a name="l00468"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#r0">00468</a>     <span class="keyword">private</span> <span class="keyword">final</span> String caption;
00469 
<a name="l00473"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#r1">00473</a>     <span class="keyword">private</span> <span class="keyword">final</span> String unit;
00474 
<a name="l00478"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#r2">00478</a>     <span class="keyword">private</span> <span class="keyword">final</span> String description;
00479 
<a name="l00488"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#a0">00488</a>     <span class="keyword">public</span> MeasurementValue(String caption, String unit, String description) {
00489         <span class="keywordflow">if</span> (caption == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || unit == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a> || description == <a class="code" href="namespaceikayaki_1_1gui.html#a26a2">null</a>) {
00490             <span class="keywordflow">throw</span> <span class="keyword">new</span> NullPointerException();
00491         }
00492         <span class="keyword">this</span>.caption = caption;
00493         <span class="keyword">this</span>.unit = unit;
00494         <span class="keyword">this</span>.description = description;
00495     }
00496 
00504     <span class="keyword">public</span> <span class="keyword">abstract</span> T getValue(<a class="code" href="classikayaki_1_1_measurement_step.html">MeasurementStep</a> step);
00505 
<a name="l00509"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#a2">00509</a>     <span class="keyword">public</span> String getCaption() {
00510         <span class="keywordflow">return</span> caption;
00511     }
00512 
<a name="l00516"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#a3">00516</a>     <span class="keyword">public</span> String getUnit() {
00517         <span class="keywordflow">return</span> unit;
00518     }
00519 
<a name="l00523"></a><a class="code" href="classikayaki_1_1_measurement_value_3_01_t_01_4.html#a4">00523</a>     <span class="keyword">public</span> String getDescription() {
00524         <span class="keywordflow">return</span> description;
00525     }
00526 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed May 4 13:11:04 2005 for Squid by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
