% estämme ihme "underfull \hbox (badness 10000)" -varoitukset (ei hajua mistä tulevat)
\hbadness=10000

% makrot dokumentoinnin generoimiseksi
\input{docmacro}


\section{Introduction}
\label{sec:intro}

This document describes planned architecture for the SQUID magnetometer program that will be implemented as a software engineering student project at University of Helsinki, Department of Computer Science. The clients are Lauri Pesonen with his assistants Fabio Donadini and Tomas Kohout from Department of Geophysics.

The document serves as an internal guide to the project team for aiding implementation phase, and describes the software at about level of accuracy which allows to implement the software based on this document and requirements document (version 1.1), which has user interface prototypes as appendices, and on which this document is based.

\subsection{Structure of the document}

\par Section~\ref{sec:intro} (this section) describes the meaning and structure of the document.
\par Section~\ref{sec:code} describes coding conventions used by the project group in this sowtware.
\par Section~\ref{sec:over} describes the software and architecture at high abstarction.
\par Section~\ref{sec:arch} describes planned architecture at lower abstarction, including class diagrams and a short description of each subsystem.
\par Section~\ref{sec:data} describes planned data classes.
\par Section~\ref{sec:gui} describes planned gui classes.
\par Section~\ref{sec:pack} describes planned package hierarchy.
\par Section~\ref{sec:bibl} has bibliography references (which we wont be having any).

\subsection{Glossary}

Probably dumped again...


\section{Code conventions}
\label{sec:code}

Everybody will follow the Code Conventions for the Java Programming Language set by Sun, with the following refinements.

\begin{itemize}
\item Line length will be set to 120 characters, because we prefer coding in high resolutions.
\item If possible, set your IDE to use spaces instead of tabs (to avoid problems if somebody has set tab to 4 spaces, although it should be 8). Indentation is 4 spaces, as set by Sun.
\item Every method and non-trivial field must have Javadoc comments. Every parameter, return value and exception of methods must be mentioned (except for trivial getters and setters).
\item Every if, for and while loop must use braces \texttt{\{\}}, even when there will be only one statement in the block, as set by Sun.
\item The @author comment for every class should have the name of the person who wrote (and designed) the class. Then we will know who to ask, if there are some questions about the code.
\item Every source file is subject to automatic code reformatting by a Java IDE, in which case the reformatter must follow these code conventions.
\item TODO-comments should be set by the programmer, if there is some part that needs more work. The format is \texttt{"// TODO: comments"}
\end{itemize}

The Code Conventions are available at \\
\texttt{http://java.sun.com/docs/codeconv/}

This program will be written with Java 1.5. Every programmer should have a look at the new features that were introduced to the Java language. Especially noteworthy are Generics, Foreach-loop and Enums. The following article will explain them in a nutshell. \\
\texttt{http://java.sun.com/developer/technicalArticles/releases/j2se15/}

It is recommendable for everybody to have a quick glance at Design Patterns. Here are some useful links. \\
\texttt{http://sern.ucalgary.ca/courses/SENG/609.04/W98/notes/} \\
\texttt{http://www.dofactory.com/Patterns/Patterns.aspx}


\section{Overview of the system}
\label{sec:over}

This system has two different separete project, Ikayaki-program and Squid Emulator which is subproject. Ikayaki, as main project, has graphical user interface (see requirements-document) and interface for communicating with SQUID magnetometer (Superconducting Quantum Interference Device) to measusure magnetization of minerals and rocks. Squid Emulator is vital for testing Ikayaki and it will be simple command-line program which emulates only data flow with random data and communication.

Software is plitted in two main parts in this document. Data section includes files needed for project-management, data flow in software and interface to control SQUID-system. There is also Settings for whole system and a subproject squid emulator. User Interface section documents all  graphical interface classes, nothing more. There will be no graphical user interface for squid emulator.


\section{Architecture description}
\label{sec:arch}

\begin{figure}
\begin{center}
\includegraphics[angle=90,width=14cm]{class-diagram-part1.eps}
\caption{Squid class diagram: central classes}
\label{fig:classdiagram1}
\end{center}
\end{figure}

\begin{figure}
\begin{center}
\includegraphics[angle=90,width=14cm]{class-diagram-part2.eps}
\caption{Squid class diagram: GUI classes}
\label{fig:classdiagram2}
\end{center}
\end{figure}

See Figure~\ref{fig:classdiagram1} and Figure~\ref{fig:classdiagram2}.


\subsection{Data classes and methods}

\subsubsection{Project data}

\subsubsection{Squid interface}

\subsubsection{Squid emulator}

\subsubsection{Serial communication}

SerialIO:\par
SerialIO and classes related to it takes care of the harware layer of serial communication. Using these classes Ikayaki communicates with the Degausser, Samplehandler and Magnetometer. SerialIO represents one serial port and when it's created it reserves the port to itself. SerialProperties class includes all the configuration data for the serial port.

\subsubsection{Global settings}

\subsubsection{Utilities}


\subsection{GUI classes and methods}

\subsubsection{Generic GUI components}

\subsubsection{Main window}

\subsubsection{Configuration window}

\subsubsection{Project Explorer}

\subsubsection{Calibration}

\subsubsection{Project information}

\subsubsection{Sequence and measurement data}

\subsubsection{Measurement details}

\subsubsection{Measurement controls}

\subsubsection{Graphs}

Graphs:\par
Graph panels visualice the measurement data. They are located at the lower right corner in the UI. MeasurementGraphsPanel listens to MeasurementEvents to update the measurement data in plots. AbstractPlot is an abstract class which implements all the general features of graph plots. IntensityPlot and StereoPlot extend the functionality of AbstractPlot and implement their special drawing features accordingly.


\section{Data classes and methods}
\label{sec:data}

\subsection{Project data}
\input{core-project}

\subsection{Squid interface}
\input{core-squid}

\subsection{Squid emulator}
\input{core-squidemu}

\subsection{Serial communication}
\input{core-serial}

\subsection{Global settings}
\input{core-settings}

\subsection{Utilities}
\input{core-util}


\section{GUI classes and methods}
\label{sec:gui}

\subsection{Generic GUI components}
\input{gui-generic}

\subsection{Main window}
\input{gui-main}
\input{gui-menubar}
\input{gui-statusbar}

\subsection{Configuration window}
\input{gui-configuration}

\subsection{Project Explorer}
\input{gui-explorer}

\subsection{Calibration}
\input{gui-calibration}

\subsection{Project information}
\input{gui-projectinfo}

\subsection{Sequence and measurement data}
\input{gui-sequence}

\subsection{Measurement details}
\input{gui-mdetails}

\subsection{Measurement controls}
\input{gui-mcontrols}

\subsection{Graphs}
\input{gui-graphs}


\section{Package structure}
\label{sec:pack}


\section{Bibliography}
\label{sec:bibl}
