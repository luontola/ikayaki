\section{Introduction}

This document describes requirements for a SQUID magnetometer program that will 
be designed and implemented as a software engineering student project at 
University of Helsinki at the Computer Science Department. The clients is  Lauri 
Pesonen with his assistants Fabio Donadini and Tomas Kohout from the Department 
of Geophysics.

The purpose of this project is to make a new user friendly Windows based 
software program to perform the measurements, to outline the data for the 
operator and to provide the outputs in a proper format for further processing.

This document serves as a contract between client and the project group about 
the implemented functions of the program. Particulary the use cases and 
requirements sections of this document describes those functions.



\section{Overview}

Department of Geophysics uses a SQUID magnetometer (Superconducting Quantum 
Interference Device) to measure magnetization of minerals and rocks. The 
magnetometer is controlled by a computer software that controls the electric 
components that control the device itself.

The use of the present magnetometer software (2G Enterprises Data Acquisition) 
is complicated and unnecessarily burdens the users work memory with complicated 
work phases and divergent operation in many use cases. Currently the work flow 
requires the use of various programs in different phases of the measurement, 
which is quite complicated and slow. The functions of those programs will be 
combined in to one. The present programs are also hard to learn and teach which 
limits the group of users.

The user of the device must know clearly what its state is and which operation 
is being performed at the moment. The device is delicate and expensive, so a 
misfunction must be noticed early to prevent any damage. For example, faulty 
state of demagnetizer can damage the device if it's not shut down manually in 
time.
 
The device and the program are used to carry out long and often variable 
measurement sequences, involving several stages. It's important that the 
operation sequences can be performed flexibly and fast. User must be able to 
follow the measuring procedure and to stop it and modify the sequence if there 
are unexpected changes in the results.

Further processing and analyzing of the results occurs in various other programs 
which use a standard file format. Therefore the new program has to be able to 
export these formats.



\newpage % LAYOUT FIX
\section{Use cases}

% super-makrot use caseille; huomaa että \uctitle aloittaa ja \ucend lopettaa, muuten tulee ongelma
% lopullisesta versiosta poistettavat kommentit joko 1) [], 2) \ucnote{} tai 3) \ucnotein{} sisällä
\newcommand{\ucsecdesc}[1]{\textit{#1}\\}
% vanha sivunvaihdon salliva \uctitle...
% \newcommand{\uctitle}[1]{\refstepcounter{ucnum}\textbf{UC\arabic{ucnum}: #1}\\\begin{tabular}{p{3cm}p{11cm}}}
% ...uusi sivunvaihdon estävä, jossa on purkatettu 0,32cm sisennyksen poisto
\newcommand{\uctitle}[1] {
	\refstepcounter{ucnum}
	\begin{tabular}{p{3cm}p{11cm}}
	\multicolumn{2}{p{14cm}} {
		\hspace{-0.32cm}
		\textbf{UC\arabic{ucnum}: #1}
	}\\
}
\newcommand{\ucnote}[1]{\multicolumn{2}{p{14cm}}{[\textsc{#1}]}\\}
\newcommand{\ucnotein}[1]{[\textsc{#1}]}
\newcommand{\ucscenario}[1]{\stepcounter{ucsce}\textbf{Scenario \alph{ucsce}} & #1\\}
\newcommand{\ucpre}[1]{\textbf{Precondition} & #1\\}
\newcommand{\ucpost}[1]{\textbf{Postcondition} & #1\\}
\newcommand{\ucerror}[1]{\textbf{Error condition} & #1\\}
\newcommand{\ucgd}[1]{\textbf{Goal-derived} & #1\\}
\newcommand{\ucreq}[1]{\textbf{Requirements} & #1\\}
\newcommand{\ucend}[0]{\end{tabular}\\}
\newcounter{ucnum}
\newcounter{ucsce}[ucnum]
\hbadness=10000 % estämmä ihme "underfull \hbox (badness 10000)" -varoitukset (ei hajua mistä tulevat)

This section describes planned use cases for the program. Use cases are 
derived from user interface prototype and requirements. All use cases are 
perfomed by any ordinary user and in program main screen. A simplified use 
case diagram is presented in Figure~\ref{fig:usecases}.

\begin{figure}
\begin{center}
\includegraphics[angle=90,width=14cm]{usecases.eps}
\caption{Use case diagram}
\label{fig:usecases}
\end{center}
\end{figure}

Use cases are divided to different sections, grouping logically similar use 
cases together.

Use case format: \nopagebreak

\setcounter{ucnum}{-1}
\uctitle{Use case identifier and title}
\ucnote{Possible temporary note here for project group; shall be removed from final version... Or maybe not.}
\ucscenario{First scenario for doing the use case.}
\ucscenario{Second scenario for doing the use case. ...}
\ucpre{Preconditions for use case.}
\ucpost{Postconditions for use case.}
\ucerror{Error handling, mainly if anything special needs to be done.}
\ucgd{Goal-derived use case(s) in which this use case occurs (if any); see section~\ref{seq:gduc}.}
\ucreq{Requirement(s) from which this use case derives; see section~\ref{seq:req}.}
\ucend


\subsection{Measuring}
\label{seq:ucmeasuring}

\ucsecdesc{As in any and all measuring action with the squid.}

\uctitle{Single step measuring without demagnetization}
\ucscenario{Enter as next AF demagnetization step "0" or empty (default for new projects), meaning no demagnetization, and click "Single step".}
\ucpre{AF project open, sample in sample holder.}
\ucpost{Sample measured, results on screen and appended to current project.}
\ucerror{The program shall let the user know if something went wrong.}
\ucgd{\ref{seq:gduc3}, first few steps.}
\ucreq{R1, R6, R10, R14, R17, R18}
\ucend

\uctitle{Single step measuring with (AF) demagnetization}
\ucscenario{Enter as next AF demag step a value in range of [1.1, 170.0] with steps of 0.1, and click "Single step".}
\ucpre{AF project open, sample in sample holder.}
\ucpost{Sample demagnetized and measured, results on screen and appended to current project.}
\ucerror{The program shall let the user know if something went wrong, and, should the demagnetization field not be coming down, warn user with an alarm sound.}
\ucgd{-}
\ucreq{R1, R4, R6, R10, R14, R17, R18}
\ucend

\uctitle{Automatic demagnetization-measuring sequence (AF sequence)}
\ucscenario{Enter the AF sequence (see section~\ref{seq:ucseq} for ways to enter it) and click "Measure".}
\ucpre{AF project open, sample in sample holder.}
\ucpost{Sample demagnetized according to entered AF sequence and measured after each demagnetization, results on screen and appended to current project.}
\ucerror{The program shall let the user know if something went wrong, and, should the demagnetization field not be coming down, warn user with an alarm sound.}
\ucgd{\ref{seq:gduc1} whole sequence, \ref{seq:gduc3} sequence after few single steps at the beginning.}
\ucreq{R1, R4, R6, R10, R13, R17, R18}
\ucend
\label{uc:autoseq}

  \uctitle{Pause automatic measuring sequence}
  \ucscenario{While measure sequence is running, click "Pause".}
  \ucpre{Ongoing measuring sequence (UC\ref{uc:autoseq}).}
  \ucpost{Measure sequence halts after current step is done, results on screen.}
  \ucerror{-}
  \ucgd{\ref{seq:gduc3}, Tomas pauses the sequence as the meteor demagnetizes too rapidly.}
  \ucreq{R1, R15}
  \ucend

  \uctitle{Abort automatic measuring sequence}
  \ucscenario{While measure sequence is running or paused, click "Stop now!".}
  \ucpre{Ongoing measuring sequence (UC\ref{uc:autoseq}).}
  \ucpost{Measure sequence halts immediately and program enters "fully manual" mode. The results of the interrupted measuring step might be left incomplete and the user must decide what he will do with them.}
  \ucerror{Program tells if sequence can't be aborted (and something has gone terribly wrong).}
  \ucgd{-}
  \ucreq{R1, R16}
  \ucend

\uctitle{Thellier measuring}
\ucscenario{Enter notes about the current measurement step. \ucnotein{2005-03-02 Not in current UI prototype. Details will be specified later.} Enter temperature. Click "Single step".}
\ucpre{TH project open, sample in sample holder.}
\ucpost{Sample measured, results on screen and appended to current project.}
\ucerror{As usual.}
\ucgd{\ref{seq:gduc2}, temperatures already entered, one step at 380 °C.}
\ucreq{R1, R6, R10, R14, R17, R18}
\ucend

\uctitle{Thermal measuring}
\ucnote{2005-03-02 Otherwise same as Thellier, except with Thermal all notes are ".00".}
\ucscenario{Enter temperature. Click "Single step".}
\ucpre{TH project open, sample in sample holder.}
\ucpost{Sample measured, results on screen and appended to current project.}
\ucerror{As usual.}
\ucgd{-}
\ucreq{R1, R6, R10, R14, R17, R18}
\ucend

\uctitle{Measure magnetometer ground noise}
\ucnote{2005-02-23 Not in current UI proto, nor planned for implementation.}
\ucscenario{Click "Ground noise" and "Calibrate".}
\ucpre{No ongoing measurements.}
\ucpost{Ground noise measured, results on screen and appended to "Ground noise" project.}
\ucerror{-}
\ucgd{-}
\ucreq{R1, R3, R6, R17, R18}
\ucend

\uctitle{Measure empty sample holder noise}
\ucscenario{Click "Holder noise" and "Calibrate".}
\ucpre{No ongoing measurements, empty sample holder.}
\ucpost{Holder noise measured, results on screen and appended to "Holder noise" project.}
\ucerror{-}
\ucgd{\ref{seq:gduc1}, calibration at the beginning.}
\ucreq{R1, R3, R6, R17, R18}
\ucend

\uctitle{Measure standard sample}
\ucscenario{Click "Standard sample" and "Calibrate".}
\ucpre{No ongoing measurements, standard sample in sample holder.}
\ucpost{Standard sample measured, results on screen and appended to "Standard sample" project.}
\ucerror{-}
\ucgd{-}
\ucreq{R1, R3, R6, R17, R18}
\ucend

\uctitle{Fully manual measuring}
\ucnote{2005-03-02 Even still not clear how fully manual is supposed to work...}
\ucscenario{Click any of the manual control components.}
\ucpre{No ongoing measuring action (so that manual measuring components are enabled).}
\ucpost{Manual action done, result on screen \ucnotein{and appended to current project? draw graphplots?}.}
\ucerror{-}
\ucgd{-}
\ucreq{R1, R2, R6, R10, R17, R18}
\ucend

\uctitle{Enable manual mode}
\ucnote{2005-03-01 Deleted use case, still here to remind it existed, and, to keep references working. :) Manual mode will be enabled always when no automatic measurement is running.}
\ucscenario{Click "Manual" checkbox above the manual control components.}
\ucpre{No ongoing measurement.}
\ucpost{Manual mode enabled.}
\ucerror{-}
\ucgd{-}
\ucreq{R2}
\ucend


\subsection{Exporting}
\label{seq:ucexport}

\ucsecdesc{As in exporting measurement results to another file format for other programs to use.}
\ucnotein{2005-03-02 The file format details will be specified later.}

\uctitle{Export project data into .dat file}
\ucscenario{In project explorer file list, right-click on desired project file, click "Export .dat in current directory".}
\ucscenario{In project explorer file list, right-click on desired project file, click "Export .dat to disk drive A:".}
\ucscenario{In project explorer file list, right-click on desired project file, click "Export .dat...", chooce directory and filename to export.}
\ucscenario{In project explorer file list, select multiple files with shift-click and ctrl-click, and make any of above actions.}
\ucpre{At least 1 project file in current (selected) directory.}
\ucpost{Project data exported to .dat file.}
\ucerror{Notify if file error occurs (such as no disk in A: drive).}
\ucgd{-}
\ucreq{R11}
\ucend

\uctitle{Export (thellier) project data into .tdt file}
\ucscenario{In project explorer file list, right-click on desired project file, click "Export .tdt in current directory".}
\ucscenario{In project explorer file list, right-click on desired project file, click "Export .tdt to disk drive A:".}
\ucscenario{In project explorer file list, right-click on desired project file, click "Export .tdt...", chooce directory and filename to export.}
\ucscenario{In project explorer file list, select multiple files with shift-click and ctrl-click, and make any of above actions.}
\ucpre{At least 1 project file in current (selected) directory.}
\ucpost{Project data exported to .tdt file.}
\ucerror{Notify if file error occurs (such as no disk in A: drive).}
\ucgd{-}
\ucreq{R11}
\ucend

\uctitle{Export single measurement details into .srm file}
\ucscenario{In measurement result table, right-click on desired measurement line(s), click "Export .srm in current directory".}
\ucscenario{In measurement result table, right-click on desired measurement line(s), click "Export .srm to disk drive A:".}
\ucscenario{In measurement result table, right-click on desired measurement line(s), click "Export...", chooce directory and filename to export.}
\ucscenario{In measurement result table, select multiple lines with shift-click and ctrl-click, and make any of above actions.}
\ucpre{At least 1 measurement result in current project.}
\ucpost{Measurement details exported to .srm file.}
\ucerror{Notify if file error occurs (such as no disk in A: drive).}
\ucgd{-}
\ucreq{R11}
\ucend


\subsection{Printing}
\label{seq:ucprint}

\ucsecdesc{As in printing measurement results as text or graphs.}
\ucnotein{2005-02-25 not in current UI prototype, implementation priority low.}

\uctitle{Print measurement results}
\ucscenario{Click "Print...", "Measurement results".}
\ucpre{Open project.}
\ucpost{Measurement results printed via [Java] standard printing window.}
\ucerror{Let know if printing error occurs.}
\ucgd{-}
\ucreq{R17}
\ucend

\uctitle{Print graph sheet (with 7 different graphs; described elsewhere)}
\ucscenario{Click "Print...", "Graph sheet".}
\ucpre{Open project.}
\ucpost{Measurement results printed via [Java] standard printing window.}
\ucerror{Let know if printing error occurs.}
\ucgd{-}
\ucreq{R18}
\ucend


\subsection{Projects}
\label{seq:ucproject}

\ucsecdesc{As in project files, which store all measurement results.}

\uctitle{Automatically save all measurement cycles in project file}
\ucscenario{Make any measurement action (see section~\ref{seq:ucmeasuring} for those).}
\ucpre{Project file open.}
\ucpost{After measurement (step) is done, new results appended to project file.}
\ucerror{-}
\ucgd{\ref{seq:gduc1}, \ref{seq:gduc2}, \ref{seq:gduc3}.}
\ucreq{R6, R10}
\ucend

\uctitle{Create new project}
\ucscenario{Click the empty line (which is always visible) below filenames in project explorer, enter new project name, chooce AF/TH (thellier) project, click "Create new" or press enter.}
\ucpre{Project explorer in desired directory (UC\ref{uc:choosedir}).}
\ucpost{New project created and selected.}
\ucerror{-}
\ucgd{\ref{seq:gduc1} after calibration, \ref{seq:gduc3} at the beginning.}
\ucreq{R5}
\ucend

\uctitle{Load project}
\ucscenario{Click any filename in project explorer.}
\ucpre{Project explorer in desired directory (UC\ref{uc:choosedir}). A measurement can be running at the same time (it will be highlighted in the project explorer).}
\ucpost{Existing project loaded and selected.}
\ucerror{-}
\ucgd{\ref{seq:gduc2} all samples already as project files.}
\ucreq{R7, R10}
\ucend

\uctitle{Change project explorer directory}
\ucscenario{Click into current directory textbox in project explorer, write directory to change to. If the typed directory exists, the program will open it automatically. \ucnotein{Or will a push of Enter be anyway required to change directory? Should we try both before deciding?} Pressing esc while in textbox undoes any writing, and reverts back to previous directory.}
\ucscenario{Click into current directory textbox in project explorer, start writing directory; when autocomplete-results appear below, use up/down+enter or mouseclick to select the directory. Pressing esc while in textbox undoes any writing, and reverts back to previous directory.}
\ucscenario{Click the down-arrow on the right side of current directory textbox in project explorer, choose desired directory from appearing directory history.}
\ucscenario{Click "Browse..." in project explorer, use standard [Java] file chooser to select directory to change to.}
\ucpre{There is no measurement running right now (to prevent the user from getting lost).}
\ucpost{The contents of the chosen directory are shown in the project explorer. Last modified project file in the directory will be selected and loaded; it's type (AF/TH) shall be the default type for creating a new project into that directory.}
\ucerror{If the user has typed an invalid directory and presses enter, a "No such directory" message will be displayed in place of the autocomplete-results.}
\ucgd{\ref{seq:gduc1}, \ref{seq:gduc2}, \ref{seq:gduc3}.}
\ucreq{-}
\ucend
\label{uc:choosedir}

\uctitle{Insert/edit project data}
\ucscenario{Click any of the project data checkboxes or textboxes (at lower left corner of main window) and enter value.}
\ucpre{Project file open (usually just created it).}
\ucpost{Project data changed, measuring results recalculated, saved automatically to project file. Saving can happen after a short delay to avoid unnecessary file system access.}
\ucerror{-}
\ucgd{\ref{seq:gduc1} after creating new project.}
\ucreq{R6, R8, R9}
\ucend


\subsection{Sequences}
\label{seq:ucseq}

\ucsecdesc{As in automatic demagnetization-measuring sequences (AF sequences), or, thellier temperature sequences.}

\uctitle{Insert sequence manually}
\ucscenario{Click "Tesla" (actually millitesla) or "Temp" \ucnotein{Some better names for these?} column in the last line (which is empty) of measurement result table, enter value; press down, [tab?] or enter to advance to a new line, enter value; and so on.}
\ucpre{An open project.}
\ucpost{Sequence appended to measurement result table and current project.}
\ucerror{-}
\ucgd{\ref{seq:gduc3} after creating new project.}
\ucreq{R6, R12}
\ucend

\uctitle{Insert sequence with start-step-stop values}
\ucscenario{Click "Start" textfield, insert start value (default value is the last value of the Tesla/Temp column), click "Step" textfield, insert step value, click "Stop" textfield, insert stop value, click "Add sequence" or press enter.}
\ucscenario{Click "Start" textfield, insert start value (default value is the last value of the Tesla/Temp column), press tab, insert step value, press tab, insert stop value, press enter or click "Add sequence".}
\ucpre{An open project.}
\ucpost{Sequence from {\it start} to {\it stop}, increasing by {\it step} for every step, appended to measurement result table of the current project. Value of "Start" textfield is the previous value of "Stop". "Step" and "Stop" textfields are empty. "Step" textfield has focus.}
\ucerror{If the last value in the old sequence (excluding completed measurements) is equal to the {\it start} value of this new sequence, then start the new sequence from {\it start + step}.}
\ucgd{\ref{seq:gduc3} after creating new project and entering manual values.}
\ucreq{R6, R12}
\ucend

\uctitle{Load sequence}
\ucscenario{Click down-arrow in right side of "Load set" combo box; from appearing list, click sequence to load.}
\ucpre{An open project, at least 1 saved sequence.}
\ucpost{Selected sequence appended to measurement result table and selected.}
\ucerror{(If accidentally inserted the wrong sequence, pressing del will delete it as it's selected after inserting.)}
\ucgd{\ref{seq:gduc1}, after typing project data, load "Basalt" set; \ref{seq:gduc2} set already loaded for each project file (when created).}
\ucreq{R6}
\ucend
\label{uc:loadseq}

\uctitle{Edit sequence on-the-fly}
\ucscenario{Click any unmeasured "Tesla" or "Temp" column in measurement result table, enter new value.}
\ucscenario{Click any unmeasured line in measurement result table, press del to delete that line.}
\ucscenario{Right-click any unmeasured line in measurement result table, choose "Delete" to delete that line.}
\ucscenario{Click-drag any unmeasured line in measurement result table to new position within unmeasured lines.}
\ucscenario{Select multiple unmeasured lines in measurement result table with shift-clicks and ctrl-clicks, make any of above actions (except enter new value).}
\ucpre{Unmeasured lines in current project's measurement result table (note that measuring sequence can be going on).}
\ucpost{Editing committed, saved to current project.}
\ucerror{Editing or deleting measured lines won't be allowed.}
\ucgd{\ref{seq:gduc3}, when sequence demagnetizes too rapidly, Tomas deletes unmeasured lines.}
\ucreq{R6}
\ucend
\label{uc:editseq}

\uctitle{Save sequence}
\ucscenario{Click "Load set" combo box, enter new sequence name, click "Save set". \ucnotein{2005-03-01 not in UI prototype; remove this scenario or decide later?}}
\ucscenario{Right-click any line in measurement result table, choose "Save full sequence...", enter name, press enter.}
\ucscenario{Select any lines in measurement result table with shift-clicks and ctrl-clicks, right-click on selected lines, choose "Save selected sequence...", enter name, press enter.}
\ucpre{At least 1 line in measurement results table (although you probably don't want to save a sequence with only one step x).}
\ucpost{New sequence set saved to predefined sequence file and available from "Load set" combo box.}
\ucerror{Ask whether to overwrite, if sequence with the same name already exists (allow to enter new name if choose not to overwrite).}
\ucgd{-}
\ucreq{-}
\ucend
\label{uc:saveseq}

\uctitle{Edit stored sequence}
\ucscenario{UC\ref{uc:loadseq} "Load sequence" -> UC\ref{uc:editseq} "Edit sequence" -> UC\ref{uc:saveseq} "Save sequence" with same name as the loaded sequence.}
\ucscenario{Click menu "Options"->"Sequences...", edit any sequence in appearing window... \ucnotein{2005-02-25 not in UI prototype, must be improvised :)}}
\ucpre{At least 1 saved sequence.}
\ucpost{Changes saved to predefined sequence file.}
\ucerror{-}
\ucgd{-}
\ucreq{-}
\ucend

\uctitle{Delete stored sequence}
\ucscenario{Click down-arrow in right side of "Load set" combo box; from appearing list, right-click sequence to delete, choose "Delete".}
\ucscenario{Click menu "Options"->"Sequences...", delete sequence in appearing window... \ucnotein{2005-02-25 not in UI prototype, must be improvised :)}}
\ucpre{At least 1 saved sequence.}
\ucpost{Sequence deleted, changes saved to predefined sequence file.}
\ucerror{-}
\ucgd{-}
\ucreq{-}
\ucend

\uctitle{Rename stored sequence}
\ucscenario{Click down-arrow in right side of "Load set" combo box; from appearing list, right-click sequence to rename, choose "Rename...", enter new name, press enter.}
\ucscenario{Click menu "Options"->"Sequences...", rename any sequence in appearing window... \ucnotein{2005-02-25 not in UI prototype, must be improvised :)}}
\ucpre{At least 1 saved sequence.}
\ucpost{Sequence renamed, changes saved to predefined sequence file.}
\ucerror{-}
\ucgd{-}
\ucreq{-}
\ucend



\newpage % LAYOUT FIX
\section{Requirements}
\label{seq:req}

% Makrot vaatimuksille
%\newcommand{\ReqId}[1]{\textbf{Identifier:} #1\\}
%\newcommand{\ReqName}[1]{\textbf{Name:} #1\\}
%\newcommand{\ReqDesc}[1]{\textbf{Description:} #1\\}
%\newcommand{\ReqPrio}[1]{\textbf{Priority:} #1\\}
%\newcommand{\ReqSet}[1]{\textbf{Set by:} #1\\}
%\newcommand{\ReqUc}[1]{\textbf{Use Cases:} #1\\}

% Uudet makrot vaatimuksille
\newcommand{\ReqName}[2]{
	\begin{tabular}{p{2.5cm}p{11.5cm}}
	\multicolumn{2}{p{14cm}} {
		\hspace{-0.32cm}
		\textbf{#1: #2}
	}\\
}
\newcommand{\ReqDesc}[1]{\textbf{Description} & #1\\}
\newcommand{\ReqPrio}[1]{\textbf{Priority} & #1\\}
\newcommand{\ReqSet}[1]{\textbf{Set by} & #1\\}
\newcommand{\ReqUc}[1]{\textbf{Use Cases} & #1\\}
\newcommand{\ReqEND}[0]{\end{tabular}}


Goals of the software set by client, project team and environment. Requirements 
were collected from 1) powerpoint slides received from client, 2) lectures given 
by client, 3) user observations held at the squid lab with client (used to 
collect goal-derived use cases), and 4) user interface prototype demonstrations 
given to client, after which the client gave suggestions and corrections to 
prototype functions.

Priorities are from 1 (highest) to 4 (lowest). Our goal is to fulfill at least 
the requirements with priorities 1 and 2. Requirements with priority 3 will be 
fulfilled only if time permits, and priority 4's will probably be left out.

Overview of requirements is presented in Table~\ref{tab:requirements}.

\begin{table}
\begin{tabular}{*{4}{l}}
{\bf Identifier} & {\bf Name} & {\bf Priority} & {\bf Set by} \\
\hline
% regexp-generated table of requiremnts [28.2.2005 @ 17:50] // Samuli
R1 & SQUID control and usage 		& 1 	& Client \\
R2 & Manual control 			& 3 	& Client \\
R3 & Calibration reminder 		& 2 	& Client \\
R4 & Warning signal 			& 3 	& Client \\
R5 & Create project 			& 1 	& Client \\
R6 & Autosave project 			& 1 	& Client \\
R7 & Load project 			& 1 	& Client \\
R8 & Edit project 			& 2 	& Client \\
R9 & Recalculate derived measurement data & 2 	& Client \\
R10 & Append project 			& 2 	& Client \\
R11 & Export to other file formats 	& 1 	& Client \\
R12 & Create a measurement sequence 	& 2 	& Client \\
R13 & Automatic sequence 		& 2 	& Client \\
R14 & Single step sequence 		& 2 	& Client \\
R15 & Pause automatic sequence 		& 2 	& Client \\
R16 & Panic abort 			& 1 	& Client \\
R17 & Numeric presentation of measurements & 1 	& Client \\
R18 & Graphic presentation of measurements & 3 	& Client \\
R19 & Hotkeys 				& 3 	& Client \\
R20 & Change hotkeys 			& 4 	& Client \\
QR1 & Error free 			& 1 	& Client \\
QR2 & Ease of use 			& 1 	& Client \\
QR3 & Quality of documentation 		& 2 	& Project Team \\
QR4 & Performance 			& 2 	& Project Team \\
QR5 & Expandable architecture 		& 2 	& Project Team \\
\end{tabular}
\caption{Requirements summary}
\label{tab:requirements}
\end{table}

Requirement format:
\nopagebreak

\ReqName{R0}{Name of the requirement}
\ReqDesc{Description of the requirement.}
\ReqPrio{Requirement priority from 1 (most important) to 4 (least important)}
\ReqSet{Who set the requirement; client, project team or environment}
\ReqUc{Use cases derived from this requirement}
\ReqEND


\subsection{Functional requirements}

{\it Define the services which the software offers and how the software behaves, 
including error handling. May also define things the software shall not do.}

\subsubsection{Magnetometer}

\ReqName{R1}{SQUID control and usage}
\ReqDesc{Able to control Squid-magnetometer and make measurements with it. Includes the magnetometer configuration settings.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC1, UC2, UC3, UC4, UC5, UC6, UC7, UC8, UC9, UC10, UC11}
\ReqEND

\ReqName{R2}{Manual control}
\ReqDesc{Able to operate the magnetometer manually. User can move and
rotate sample handler and measure and demagnetize sample.}
\ReqPrio{3}
\ReqSet{Client}
\ReqUc{UC11, UC12}
\ReqEND

\ReqName{R3}{Calibration reminder}
\ReqDesc{Magnetometer must be calibrated every 24 hours. The program will remind the user when it would be time to do calibration.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC8, UC9, UC10}
\ReqEND

\ReqName{R4}{Warning signal}
\ReqDesc{Program should warn user with alarm signal if magnetic field remains on for too long. The implementation depends on if the Degaussing System's protocol makes it possible.}
\ReqPrio{3}
\ReqSet{Client}
\ReqUc{UC2, UC3}
\ReqEND


\subsubsection{Project files}

\ReqName{R5}{Create project}
\ReqDesc{Create a new project file which will include the measurement sequence, measurement results and information about the sample. The file format will be custom made for this program.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC19}
\ReqEND

\ReqName{R6}{Autosave project}
\ReqDesc{Program will save measurement data and project information after every measurement step and modification.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC1, UC2, UC3, UC6, UC7, UC8, UC9, UC10, UC11, UC18, UC22, UC23, UC24, UC25, UC26}
\ReqEND

\ReqName{R7}{Load project}
\ReqDesc{Saved projects can be loaded into program.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC20}
\ReqEND

\ReqName{R8}{Edit project}
\ReqDesc{Ability edit project information and measurement data afterwards. \ucnotein{2005-03-02 The editable data fields will be decided later.}}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC22}
\ReqEND

\ReqName{R9}{Recalculate derived measurement data}
\ReqDesc{When the measurement data or the mass/volume of the specimen is changed, recalculate all numbers that have been derived from the modified data.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC22}
\ReqEND

\ReqName{R10}{Append project}
\ReqDesc{New measurements can be added to existing projects.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC1, UC2, UC3, UC6, UC7, UC11, UC18, UC20}
\ReqEND

\ReqName{R11}{Export to other file formats}
\ReqDesc{Measurements can be saved in .dat, .tdt and .srm files. \ucnotein{2005-03-02 File format specifications will be recieved later.}}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC13, UC14, UC15}
\ReqEND


\subsubsection{Measurements}

\ReqName{R12}{Create a measurement sequence}
\ReqDesc{Able to create AF, Thermal and Thellier measurement sequences with several different sized steps.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC23, UC24}
\ReqEND

\ReqName{R13}{Automatic sequence}
\ReqDesc{Do all the measurement steps automatically. Pause after all steps have been completed.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC3}
\ReqEND

\ReqName{R14}{Single step sequence}
\ReqDesc{Do only one measurement step at a time.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC1, UC2, UC6, UC7}
\ReqEND

\ReqName{R15}{Pause automatic sequence}
\ReqDesc{Able to stop the measurement sequence after current step. After being stopped, the user can make modifications to the sequence and continue from where the sequence was left.}
\ReqPrio{2}
\ReqSet{Client}
\ReqUc{UC4}
\ReqEND

\ReqName{R16}{Panic abort}
\ReqDesc{Able to stop any measurement immediately. The demagnetizer will be forced to zero and the sample holder will stop where it is. The current measurement step's data might be discarded.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC5}
\ReqEND

\ReqName{R17}{Numeric presentation of measurements}
\ReqDesc{Program shows measurement data in a table as numbers. Measurement data will be displayed using either scientic notation (1.23e4) or decimal numbers. \ucnotein{2005-03-02 The data fields (if different from the UI proto) will be decided later. The client will tell how they are calculated.}}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{UC1, UC2, UC3, UC6, UC7, UC8, UC9, UC10, UC11, UC16}
\ReqEND

\ReqName{R18}{Graphic presentation of measurements}
\ReqDesc{Program draws graphs from measurement data. The most important graph types are Stereo Plot and Intensity. Low priority are Zijderveld and Difference Vectors. Lowest priority are Susteptibility, O63 (not needed) and Great Circles (not needed). \ucnotein{2005-03-02 The client will tell the graph specifications as necessary.}}
\ReqPrio{3}
\ReqSet{Client}
\ReqUc{UC1, UC2, UC3, UC6, UC7, UC8, UC9, UC10, UC11, UC17}
\ReqEND


\subsubsection{Others}

\ReqName{R19}{Hotkeys}
\ReqDesc{The program has hotkeys for the most often used operations.}
\ReqPrio{3}
\ReqSet{Client}
\ReqUc{-}
\ReqEND

\ReqName{R20}{Change hotkeys}
\ReqDesc{Possibility to change hotkey assignments.}
\ReqPrio{4}
\ReqSet{Client}
\ReqUc{-}
\ReqEND


\subsection{Quality requirements}

\ReqName{QR1}{Error free}
\ReqDesc{The program should not crash. All the functions need to work as documented. The calculations that the program makes from measurements must be done right.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{-}
\ReqEND

\ReqName{QR2}{Ease of use}
\ReqDesc{Program should be easy to use for first time users after it has been explained to them how to take measurements with the magnetometer.}
\ReqPrio{1}
\ReqSet{Client}
\ReqUc{-}
\ReqEND

\ReqName{QR3}{Quality of documentation}
\ReqDesc{The documentation must be so good that other teams can easily continue the development. Program should have good help pages for the end-users.}
\ReqPrio{2}
\ReqSet{Project Team}
\ReqUc{-}
\ReqEND

\ReqName{QR4}{Performance}
\ReqDesc{The program must keep up with the SQUID hardware (which is very slow compared to a PC). The user interface should not freeze for periods of over 0,5 seconds.}
\ReqPrio{2}
\ReqSet{Project Team}
\ReqUc{-}
\ReqEND

\ReqName{QR5}{Expandable architecture}
\ReqDesc{The program structure should be modular and easy to develop further. It should be possible to expand the program to process the measurement data in more ways.}
\ReqPrio{2}
\ReqSet{Project Team}
\ReqUc{-}
\ReqEND


\subsection{Environment}

{\it This section defines requirements for the software which originate from the 
environment in which the software will be working, and which the software must 
satisfy for being able to work in its environment.}

Program will be used in normal PC which is connected to magnetometer. The 
computer that will run this program will be equal or better to 1GHz CPU, 256MB 
RAM, 1280x1024 resolution. The current computer is running Windows XP.

Taking into account the rapid speed of computer evolution it is possible that 
the computer in which the program is used can change. Accordingly, the program 
should be installable by outsiders. We need not prepare to the changing of the 
magnetometer, as a new magnenetometer will probably have its own program. This 
program does not control the temparature of the magnetometer.

The SQUID hardware and communication with it are described in the section 
"External interfaces".


\subsection{Maintainability}

It must be possible to continue the development of the program. The 
documentation must be complete enough so that other teams can quickly continue 
the development even if they have not studied user interface designing. It must 
be possible to add new graph types to the program and export the measurement 
data to other programs.



%\newpage % LAYOUT FIX
\section{User interface}

User interface for the program is loosely generated from goal-derived use 
cases, which in turn were collected by user observations held with the client 
at their magnetometer lab (using the old squid software).

Method for generating the user interface is "applied GDD". GDD, or {\it 
Goal-Derived Design}, is taught on courses "User Interfaces" and "User 
Interfaces II" at Department of Computer Science. For more info, see
\nopagebreak

\hspace{1cm}
\begin{tabular}{l}
{\tt http://www.cs.helsinki.fi/u/salaakso/} \\
{\tt Goal-derived design?} \\
{\tt Goal-derived use cases?}
\end{tabular}

\subsection{Goal-derived use cases}
\label{seq:gduc}

There were three user observations held, and those generated three goal-derived 
use cases. The picture sequences of each use case are in the appendices.

In the picture sequences is shown how the program is being used. Every mouse 
click is indicated with a cursor; follow the white mouse. The typing of text is 
shown in like manner. Details of the magnetometer measurement sequences have 
been left out from most of the places to save trees. Only in the first use case, 
in the first step of the measurement sequence (not calibration), is shown all 
the phases.


\subsubsection{Use case 1: Erkki studies the movement of Antarctis}
\label{seq:gduc1}

\textbf{Erkki's goal:} \\
To measure where Antarctis was 180 miljon years ago.

\textbf{Information:} \\
- Now is Tuesday 8.2.2005 at 14:27 \\
- Erkki is in laboratory at Physicum

\textbf{Erkki's knowledge:} \\
- He has many samples from Antarctis, hand sample, drill's and logbook and data from earlier measurements. \\
- He has available libra, waterpool and SQUID-equipment and continent draw program \\
- He can assume good results because sample is Basalt and he knows how basalt usually is magnetised. \\
- Hand sample has line which projects to north pole and on drill is same line.

\textbf{Logbook:} \\
Area: Antarctis \\
Site: Utpostane \\
Map: 1134 \\
X: \\
Y: \\
Latitude: 344 \\
Longitude: -74 \\
Sample: UP-17 \\
Core[ ]/Hand[x] \\
Rock Tybe: Basalt \\
Comments: Dike 10m tos, fine grained, altered?

Orientation: \\
Date: 14.06.1997 \\
Time: 13:02 \\
Magn. decl: 289 + -9 = 280 \\
Dip 14


\subsubsection{Use case 2: Anomaly in magnetic field at year 500}
\label{seq:gduc2}

\textbf{Lauri's goal:} \\
Department of Geophysics' head Lauri Pesonen has been researching samples from Finland around 500 a.d., and measuring them has given some suggestion that there was a peak in Earth magnetic field at that time. Lauri needs more research about the issue, to see if there's some truth in it.

\textbf{Fabio's goal:} \\
Lauri has asked Fabio to study more samples from that time, to be sure about the possible peak in magnetic field 1500 years ago.

\textbf{Information:} \\
- It's Wednesday 9.2.2005 15:05, Fabio is at Geophysics Department's lab in the basement of Physicum, Lauri in his office at third flood \\
- Fabio has 19 pieces of Estonian jars from year 500, each sample has its own cryptic code name marked on \\
- Jar pieces are in tubes made of substance X, to make them fit nicely inside magnetometer sample handler \\
- Estonian samples have already been thellier-measured up to 350 Celsius demagnetization, next up is 380 Celsius. \\
- Around 10 of the samples are in the oven cooling down from their 50 minute warming up, cooling also takes 50 minutes \\
- As the other half of samples is cooling, the other is at the same time conveniently warming up \\
- Results from previous temperatures are in one project file per sample at the Squid-computer \\
- All samples are supposed to go through the same cycle (which they already have followed up to 350 Celsius): warm up n degrees->cool down without field->measure->warm up n degrees (again)->cool down with field->measure->warm up n+m degrees... \\
- First one in the next set appears to be sample "pd2-1a"

\textbf{Fabio's knowledge:} \\
- Previous results from Finnish samples suggest that magnetic field was surprisingly high back then \\
- Fabio can't yet tell what kind of final results to expect


\subsubsection{Use case 3: Tomas studies meteor magnetism}
\label{seq:gduc3}

\textbf{Tomas' goal:} \\
To get some idea how meteor rocks are magnetised.

\textbf{Information:} \\
- Now is Monday 14.2.2005 klo 15:15 \\
- Tomas is in laboratory at Physicum \\
- Tomas has many samples from meteors and he has splitted some of them into two kind of rocks: old rock pieces and gluerock (space dust?). This particular meteor is from Brazil named Avandahah.

\textbf{Tomas' knowledge:} \\
- Tomas has some insight how meteors are magnetized, but he never can be sure \\
- Tomas has previously weighted stones: glue 0.0033gm, old 0.0020gm



\newpage % LAYOUT FIX
\section{Architecture overview}

The program architecture can be divided into three parts: SQUID interface, 
measurement project and user interface. The program will communicate with the 
SQUID hardware and local file system. A graphical representation of the 
architecture can be seen in Figure~\ref{fig:architecture}.

\begin{figure}
\begin{center}
\includegraphics[width=10cm]{architecture.eps}
\caption{Architecture overview}
\label{fig:architecture}
\end{center}
\end{figure}

SQUID interface is responsible for controlling the hardware in an orderly 
manner. It will provide high- and low-level controls for using the hardware. 
Communication with the hardware is done via COM ports. The SQUID interface will 
hide the protocol-level commands from the programmer and prevent illegal use of 
the hardware.

Measurement project is responsible for managing the project information, 
measurement sequence and measurement data. It will recieve commands from the 
user interface and notify the UI when the state of the project changes. It will 
send commands to the SQUID interface, recieve measurement data and save it. When 
the internal data of the project changes, the copy on the local file system will 
be automatically synchronized after a short delay (1 second or less).

User interface is responsible for communicating with the user of the program. It 
will update itself whenever the state of the measurement project is changed. It 
will send commands from the user to the program.



\newpage % LAYOUT FIX
\section{External interfaces}

{\it Interfaces to existing software and hardware.}

\subsection{Existing program}

The existing software for using the SQUID is "2G Enterprises Data Acquisition". 
We have access to the source code for version 2.99.3 of the program. From the 
old source code we will reuse basically only the SerialIO component and build an 
interface for communicating with the SQUID hardware by using Java and JNI (Java 
Native Interface).

\subsection{Hardware control protocols}

The SQUID consists of three independent units:

\begin{itemize}
\item Automated Sample Handler System (MODEL 2G800)
\item Automatic Sample Degaussing System (MODEL 2G600)
\item Superconducting Rock Magnetometer (MODEL 755R or 760R)
\end{itemize}

Automated Sample Handler System controls the movement and rotation of the sample 
holder. Its protocol is described in the appendices.

Automatic Sample Degaussing System controls the demagnetizer. Its protocol is 
described in the appendices.

Superconducting Rock Magnetometer reads the measurements from the magnetometer. 
Its protocol is described in the appendices.



\section{Validation}

In validation it is being checked that a product meets the requirements set for 
it. Sometimes the requirements have priorities and only the most important 
requirements are demanded. In document reviews, held between the client and the 
project team, it will be established that the requirements document and the 
design document are in line with user requirements and will lead to the 
production of a program which meets these requirements. Testing shows that the 
program actually works as specified by the design document. Finally the finished 
product will be checked against this requirements document.
