\beginTestedClass{Automatic AF Measurement}

\beginCase{Open software
\condition{Last project is opened, if available.
\condition{All components are in right place
\closeCase

\beginCase{Select Sample holder calibration
\condition{opens Sample holder calibration project in Measurement Sequence and Information
\condition{disables Measurement Controls
\condition{enables calibrate button
\condition{disables editing sequence
\closeCase

\beginCase{Click Calibration button
\condition{Adds new line in Sequence at bottom
\condition{Starts calibration, progress shown on measurement controls
\condition{Data is updated correctly in Measurement Details
\condition{Calibration button changed to stop button
\closeCase

\beginCase{Calibration finished
\condition{New data added to Measurement Sequence
\condition{Stop button is changed to calibration button
\condition{Last modified is updated Sample Holder
\closeCase

\beginCase{Select standard sample
\condition{opens Standard Sample calibration project in Measurement Sequence
\closeCase

\beginCase{Click Calibration button
\condition{Adds new line in Sequence at bottom
\condition{Starts calibration, progress shown on measurement controls
\condition{Data is updated correctly in Measurement Details
\condition{Calibration button changed to stop button
\closeCase

\beginCase{Calibration finished
\condition{New data added to Measurement Sequence
\condition{stop button is changed to calibration button
\condition{Last modified is updated in Standard Sample
\closeCase

\beginCase{Create new AF project
\condition{Calibration project is closed
\condition{new AF project is opened with given name (ProjectInfo,MeasurementSequence)
\condition{Measurement Controls has enabled buttons Measure,Single Step and disable Stop Now!
\closeCase

\beginCase{Add project Information
\condition{All data is accepted
\closeCase

\beginCase{Load Set
\condition{Loaded set is correctly added to Sequence
\closeCase

\beginCase{Click Measure
\condition{Measure button changed to Pause, disables Single Step, enables Stop Now!
\condition{Rows are highlighted in Explorer and Sequence
\condition{Starts measuring first phase correctly (no demag now)
\condition{Picture of demagnetizer is up-to-date
\condition{Plots are drawn when one phase is over
\condition{Continues on next phase and does demag first
\condition{updates Details and Sequence
\condition{any sequence cannot be changed 
\closeCase

\beginCase{Pause button
\condition{Finish current measure and stops after that
\condition{Pause button changed to Measure button
\condition{When finished disables Stop Now!
\closeCase

\beginCase{Sequence edit
\condition{Steps not yet measured, can be changed
\closeCase

\beginCase{Single step button
\condition{Performs Next phase on measure
\condition{Disables Measure button and Single Step button, enables Stop Now!
\closeCase

\beginCase{Measure button
\condition{Measure button changed to Pause, disables Single Step, enables Stop Now!
\condition{Rows are highlighted in Explorer and Sequence
\condition{Continues from Next phase
\condition{Picture of demagnetizer is up-to-date
\condition{Plots are drawn when one phase is over
\condition{Continues on next phase
\condition{updates Details and Sequence
\closeCase

\beginCase{Stop Now! button
\condition{Stops measurement immediatelly.
\condition{Disables buttons and enables Manual Control
\condition{What now? Is project Manual or is this only temporary?
\closeCase

\closeTestedClass